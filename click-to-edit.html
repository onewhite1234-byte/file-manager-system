<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Âç≥ÊôÇÊñá‰ª∂Á∑®ËºØÁ≥ªÁµ± | ÈªûÊìäÂç≥Á∑®ËºØ</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Âü∫Á§éÊ®£Âºè */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        :root {
            --primary-color: #4361ee;
            --secondary-color: #3a0ca3;
            --success-color: #4cc9f0;
            --danger-color: #f72585;
            --warning-color: #f8961e;
            --light-color: #f8f9fa;
            --dark-color: #212529;
            --gray-color: #6c757d;
            --sidebar-width: 280px;
        }

        body {
            background-color: #f5f7fb;
            color: var(--dark-color);
            height: 100vh;
            overflow: hidden;
        }

        /* ÁôªÈåÑÈ†ÅÈù¢ */
        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            padding: 20px;
        }

        .login-box {
            background-color: white;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 400px;
            padding: 40px;
        }

        .login-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .login-header h1 {
            color: var(--primary-color);
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }

        .form-control:focus {
            border-color: var(--primary-color);
            outline: none;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background-color: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background-color: #3251d4;
        }

        .btn-success {
            background-color: var(--success-color);
            color: white;
        }

        .btn-danger {
            background-color: var(--danger-color);
            color: white;
        }

        .btn-block {
            width: 100%;
            padding: 14px;
        }

        /* ‰∏ªÊáâÁî®‰ΩàÂ±Ä */
        #app-page {
            display: none;
            height: 100vh;
        }

        .app-container {
            display: flex;
            height: 100%;
        }

        /* ÂÅ¥ÈÇäÊ¨Ñ */
        .sidebar {
            width: var(--sidebar-width);
            background: linear-gradient(180deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 20px 0;
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        .sidebar-header {
            padding: 0 20px 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 20px;
        }

        .sidebar-header h2 {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.5rem;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 15px;
            padding: 10px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
        }

        .user-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background-color: white;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        .nav-links {
            list-style: none;
            flex: 1;
        }

        .nav-links li {
            margin-bottom: 5px;
        }

        .nav-links a {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 15px 20px;
            color: rgba(255, 255, 255, 0.9);
            text-decoration: none;
            transition: all 0.3s;
            font-size: 1rem;
        }

        .nav-links a:hover, .nav-links a.active {
            background-color: rgba(255, 255, 255, 0.1);
            color: white;
            border-left: 4px solid var(--success-color);
        }

        /* ‰∏ªÂÖßÂÆπÂçÄ */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        /* Êñá‰ª∂ÂàóË°®È†ÅÈù¢ */
        .files-header {
            padding: 20px 30px;
            background: white;
            border-bottom: 1px solid #e9ecef;
        }

        .files-header h1 {
            font-size: 1.8rem;
            color: var(--dark-color);
            margin-bottom: 10px;
        }

        .files-toolbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 20px;
        }

        .search-box {
            display: flex;
            gap: 10px;
            flex: 1;
            max-width: 400px;
        }

        .search-input {
            flex: 1;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
        }

        .files-content {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
            background-color: #f8f9fa;
        }

        .files-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
        }

        .file-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
            position: relative;
        }

        .file-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
            border-color: var(--primary-color);
        }

        .file-card.active {
            border-color: var(--primary-color);
            background-color: #e7f3ff;
        }

        .file-icon {
            width: 60px;
            height: 60px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            color: white;
            margin-bottom: 15px;
        }

        .file-icon.txt { background-color: #4d96ff; }
        .file-icon.md { background-color: #6bcf7f; }
        .file-icon.pdf { background-color: #ff6b6b; }
        .file-icon.doc { background-color: #4361ee; }
        .file-icon.img { background-color: #ffd166; }
        .file-icon.zip { background-color: #9d4edd; }

        .file-info h3 {
            font-size: 1.1rem;
            margin-bottom: 5px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .file-info p {
            color: var(--gray-color);
            font-size: 0.9rem;
            margin-bottom: 3px;
        }

        .file-actions {
            position: absolute;
            top: 10px;
            right: 10px;
            display: flex;
            gap: 5px;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .file-card:hover .file-actions {
            opacity: 1;
        }

        .action-btn {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1rem;
            color: var(--gray-color);
            padding: 5px;
        }

        .action-btn:hover {
            color: var(--primary-color);
        }

        /* Á∑ö‰∏äÁ∑®ËºØÂô®È†ÅÈù¢ */
        .editor-container {
            display: flex;
            flex-direction: column;
            height: 100%;
            background: white;
        }

        .editor-header {
            padding: 20px 30px;
            border-bottom: 1px solid #e9ecef;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: white;
        }

        .editor-title {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .file-type-badge {
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .badge-txt { background-color: #e7f3ff; color: #0066cc; }
        .badge-md { background-color: #d4edda; color: #155724; }
        .badge-pdf { background-color: #ffebee; color: #c62828; }

        .editor-status {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .sync-status {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
        }

        .sync-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
        }

        .sync-saved { background-color: #4caf50; }
        .sync-saving { background-color: #ff9800; animation: pulse 1.5s infinite; }
        .sync-error { background-color: #f44336; }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        .editor-main {
            flex: 1;
            display: flex;
            overflow: hidden;
        }

        .editor-sidebar {
            width: 250px;
            border-right: 1px solid #e9ecef;
            background: #f8f9fa;
            overflow-y: auto;
            padding: 20px;
        }

        .editor-content {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .editor-toolbar {
            padding: 15px 20px;
            background: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .editor-area {
            flex: 1;
            display: flex;
            position: relative;
        }

        #editor-textarea {
            width: 100%;
            height: 100%;
            border: none;
            outline: none;
            resize: none;
            font-size: 1rem;
            line-height: 1.6;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            padding: 20px;
            background: white;
        }

        #preview-area {
            width: 100%;
            height: 100%;
            padding: 20px;
            overflow-y: auto;
            background: white;
            display: none;
        }

        .preview-content {
            max-width: 800px;
            margin: 0 auto;
        }

        .preview-content h1,
        .preview-content h2,
        .preview-content h3 {
            margin-top: 1.5em;
            margin-bottom: 0.5em;
            color: var(--dark-color);
        }

        .preview-content p {
            margin-bottom: 1em;
            line-height: 1.6;
        }

        .preview-content code {
            background-color: #f8f9fa;
            padding: 2px 5px;
            border-radius: 3px;
            font-family: monospace;
        }

        .preview-content pre {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 1em 0;
        }

        /* Ê®°ÊÖãÊ°Ü */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background-color: white;
            border-radius: 10px;
            width: 90%;
            max-width: 500px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--gray-color);
        }

        /* ÈüøÊáâÂºèË®≠Ë®à */
        @media (max-width: 992px) {
            .app-container {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                height: auto;
            }
            
            .nav-links {
                display: flex;
                overflow-x: auto;
            }
            
            .nav-links li {
                flex-shrink: 0;
            }
            
            .editor-main {
                flex-direction: column;
            }
            
            .editor-sidebar {
                width: 100%;
                height: 200px;
            }
        }
    </style>
</head>
<body>
    <!-- ÁôªÈåÑÈ†ÅÈù¢ -->
    <div id="login-page" class="login-container">
        <div class="login-box">
            <div class="login-header">
                <h1><i class="fas fa-file-edit"></i> Âç≥ÊôÇÊñá‰ª∂Á∑®ËºØÁ≥ªÁµ±</h1>
                <p>ÈªûÊìäÊñá‰ª∂Áõ¥Êé•Á∑®ËºØÔºåÂØ¶ÊôÇÂêåÊ≠•‰øùÂ≠ò</p>
            </div>
            
            <form id="login-form">
                <div class="form-group">
                    <input type="text" id="username" class="form-control" placeholder="Áî®Êà∂Âêç" value="admin" required>
                </div>
                <div class="form-group">
                    <input type="password" id="password" class="form-control" placeholder="ÂØÜÁ¢º" value="password123" required>
                </div>
                <button type="submit" class="btn btn-primary btn-block">
                    <i class="fas fa-sign-in-alt"></i> ÈÄ≤ÂÖ•Á≥ªÁµ±
                </button>
            </form>
            
            <div style="margin-top: 20px; text-align: center; color: var(--gray-color); font-size: 0.9rem;">
                <p>ÊºîÁ§∫Ë≥¨Ëôü: admin / password123</p>
                <p>ÊâÄÊúâÊï∏ÊìöÂØ¶ÊôÇ‰øùÂ≠òÂú®ÁÄèË¶ΩÂô®‰∏≠</p>
            </div>
        </div>
    </div>

    <!-- ‰∏ªÊáâÁî®È†ÅÈù¢ -->
    <div id="app-page">
        <div class="app-container">
            <!-- ÂÅ¥ÈÇäÊ¨Ñ -->
            <aside class="sidebar">
                <div class="sidebar-header">
                    <h2><i class="fas fa-cloud"></i> Êñá‰ª∂Á∑®ËºØÂô®</h2>
                    <div class="user-info">
                        <div class="user-avatar" id="user-avatar">A</div>
                        <div>
                            <div id="user-name">ÁÆ°ÁêÜÂì°</div>
                            <div style="font-size: 0.8rem; opacity: 0.8;">Â∑≤ÁôªÈåÑ</div>
                        </div>
                    </div>
                </div>
                
                <ul class="nav-links">
                    <li><a href="#" class="active" data-page="files"><i class="fas fa-folder"></i> ÊâÄÊúâÊñá‰ª∂</a></li>
                    <li><a href="#" data-page="recent"><i class="fas fa-history"></i> ÊúÄËøëÁ∑®ËºØ</a></li>
                    <li><a href="#" data-page="create"><i class="fas fa-plus"></i> Êñ∞Âª∫Êñá‰ª∂</a></li>
                    <li><a href="#" data-page="trash"><i class="fas fa-trash"></i> ÂõûÊî∂Á´ô</a></li>
                    <li><a href="#" data-page="backup"><i class="fas fa-database"></i> Êï∏ÊìöÂÇô‰ªΩ</a></li>
                    <li style="margin-top: auto;">
                        <a href="#" id="logout-btn">
                            <i class="fas fa-sign-out-alt"></i> ÈÄÄÂá∫Á≥ªÁµ±
                        </a>
                    </li>
                </ul>
            </aside>

            <!-- ‰∏ªÂÖßÂÆπÂçÄ -->
            <main class="main-content">
                <!-- Êñá‰ª∂ÂàóË°®È†ÅÈù¢ -->
                <div id="files-page" class="page active">
                    <div class="files-header">
                        <h1>ÊàëÁöÑÊñá‰ª∂</h1>
                        <p>ÈªûÊìä‰ªª‰ΩïÊñá‰ª∂ÈñãÂßãÁ∑®ËºØÔºåÊâÄÊúâÊõ¥ÊîπËá™Âãï‰øùÂ≠ò</p>
                        
                        <div class="files-toolbar">
                            <div class="search-box">
                                <input type="text" class="search-input" id="file-search" placeholder="ÊêúÁ¥¢Êñá‰ª∂Âêç...">
                                <button class="btn btn-primary" id="search-btn">
                                    <i class="fas fa-search"></i>
                                </button>
                            </div>
                            
                            <button class="btn btn-success" id="upload-file-btn">
                                <i class="fas fa-upload"></i> ‰∏äÂÇ≥Êñá‰ª∂
                            </button>
                        </div>
                    </div>
                    
                    <div class="files-content">
                        <div class="files-grid" id="files-grid">
                            <!-- Êñá‰ª∂Âç°ÁâáÂ∞áÂãïÊÖãÁîüÊàê -->
                        </div>
                    </div>
                </div>

                <!-- Á∑ö‰∏äÁ∑®ËºØÂô®È†ÅÈù¢ -->
                <div id="editor-page" class="page">
                    <div class="editor-container">
                        <div class="editor-header">
                            <div class="editor-title">
                                <button class="btn" id="back-to-files">
                                    <i class="fas fa-arrow-left"></i>
                                </button>
                                <div>
                                    <h2 id="editor-filename">Êú™ÂëΩÂêçÊñá‰ª∂</h2>
                                    <div style="display: flex; align-items: center; gap: 10px; margin-top: 5px;">
                                        <span class="file-type-badge" id="file-type-badge">TXT</span>
                                        <span style="font-size: 0.9rem; color: var(--gray-color);">
                                            ÊúÄÂæå‰øÆÊîπ: <span id="last-modified">ÂâõÂâõ</span>
                                        </span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="editor-status">
                                <div class="sync-status">
                                    <div class="sync-dot sync-saved" id="sync-status"></div>
                                    <span id="sync-text">Â∑≤ÂêåÊ≠•</span>
                                </div>
                                
                                <button class="btn btn-primary" id="preview-toggle">
                                    <i class="fas fa-eye"></i> È†êË¶Ω
                                </button>
                                
                                <button class="btn btn-success" id="save-btn">
                                    <i class="fas fa-save"></i> ‰øùÂ≠ò
                                </button>
                                
                                <button class="btn btn-danger" id="delete-file-btn">
                                    <i class="fas fa-trash"></i> Âà™Èô§
                                </button>
                            </div>
                        </div>
                        
                        <div class="editor-main">
                            <div class="editor-sidebar">
                                <h3 style="margin-bottom: 15px;">Êñá‰ª∂‰ø°ÊÅØ</h3>
                                <div style="margin-bottom: 20px;">
                                    <div style="font-size: 0.9rem; color: var(--gray-color); margin-bottom: 5px;">Êñá‰ª∂ÂêçÁ®±</div>
                                    <input type="text" id="rename-file" class="form-control" style="width: 100%;">
                                </div>
                                
                                <div style="margin-bottom: 20px;">
                                    <div style="font-size: 0.9rem; color: var(--gray-color); margin-bottom: 5px;">Êñá‰ª∂È°ûÂûã</div>
                                    <select id="change-file-type" class="form-control" style="width: 100%;">
                                        <option value="txt">Á¥îÊñáÊú¨ (.txt)</option>
                                        <option value="md">Markdown (.md)</option>
                                        <option value="html">HTML (.html)</option>
                                        <option value="css">CSS (.css)</option>
                                        <option value="js">JavaScript (.js)</option>
                                        <option value="json">JSON (.json)</option>
                                    </select>
                                </div>
                                
                                <div style="margin-bottom: 20px;">
                                    <div style="font-size: 0.9rem; color: var(--gray-color); margin-bottom: 5px;">Êñá‰ª∂Â§ßÂ∞è</div>
                                    <div id="file-size-info">0 KB</div>
                                </div>
                                
                                <div style="margin-bottom: 20px;">
                                    <div style="font-size: 0.9rem; color: var(--gray-color); margin-bottom: 5px;">ÂâµÂª∫ÊôÇÈñì</div>
                                    <div id="file-created">Êú™Áü•</div>
                                </div>
                                
                                <div style="margin-top: 30px;">
                                    <h3 style="margin-bottom: 15px;">Âø´ÈÄüÊìç‰Ωú</h3>
                                    <button class="btn btn-block" style="margin-bottom: 10px;" id="download-file-btn">
                                        <i class="fas fa-download"></i> ‰∏ãËºâÊñá‰ª∂
                                    </button>
                                    <button class="btn btn-block" id="duplicate-file-btn">
                                        <i class="fas fa-copy"></i> Ë§áË£ΩÊñá‰ª∂
                                    </button>
                                </div>
                            </div>
                            
                            <div class="editor-content">
                                <div class="editor-toolbar">
                                    <button class="btn" data-format="bold">
                                        <i class="fas fa-bold"></i>
                                    </button>
                                    <button class="btn" data-format="italic">
                                        <i class="fas fa-italic"></i>
                                    </button>
                                    <button class="btn" data-format="code">
                                        <i class="fas fa-code"></i>
                                    </button>
                                    <button class="btn" data-format="link">
                                        <i class="fas fa-link"></i>
                                    </button>
                                    <button class="btn" data-format="list">
                                        <i class="fas fa-list"></i>
                                    </button>
                                    <button class="btn" data-format="heading">
                                        <i class="fas fa-heading"></i>
                                    </button>
                                </div>
                                
                                <div class="editor-area">
                                    <textarea id="editor-textarea" placeholder="ÈñãÂßãÁ∑®ËºØÊÇ®ÁöÑÊñá‰ª∂ÂÖßÂÆπ...&#10;&#10;ÊîØÊåÅÂç≥ÊôÇÂêåÊ≠•‰øùÂ≠òÔºåÊâÄÊúâÊõ¥ÊîπÊúÉËá™Âãï‰øùÂ≠òÂà∞ÁÄèË¶ΩÂô®‰∏≠„ÄÇ"></textarea>
                                    
                                    <div id="preview-area">
                                        <div class="preview-content" id="preview-content"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Êñ∞Âª∫Êñá‰ª∂Ê®°ÊÖãÊ°Ü -->
    <div class="modal" id="new-file-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>ÂâµÂª∫Êñ∞Êñá‰ª∂</h3>
                <button class="close-modal" id="close-new-file-modal">&times;</button>
            </div>
            <form id="new-file-form">
                <div class="form-group">
                    <label>Êñá‰ª∂ÂêçÁ®±</label>
                    <input type="text" id="new-file-name" class="form-control" placeholder="‰æãÂ¶ÇÔºöÊàëÁöÑÁ≠ÜË®ò" required>
                </div>
                <div class="form-group">
                    <label>Êñá‰ª∂È°ûÂûã</label>
                    <select id="new-file-type" class="form-control">
                        <option value="txt">Á¥îÊñáÊú¨ (.txt)</option>
                        <option value="md">Markdown (.md)</option>
                        <option value="html">HTML (.html)</option>
                        <option value="css">CSS (.css)</option>
                        <option value="js">JavaScript (.js)</option>
                        <option value="json">JSON (.json)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>ÂàùÂßãÂÖßÂÆπ (ÂèØÈÅ∏)</label>
                    <textarea id="new-file-content" class="form-control" rows="4" placeholder="Ëº∏ÂÖ•Êñá‰ª∂ÁöÑÂàùÂßãÂÖßÂÆπ..."></textarea>
                </div>
                <button type="submit" class="btn btn-primary btn-block">ÂâµÂª∫Êñá‰ª∂</button>
            </form>
        </div>
    </div>

    <!-- ‰∏äÂÇ≥Êñá‰ª∂Ê®°ÊÖãÊ°Ü -->
    <div class="modal" id="upload-file-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>‰∏äÂÇ≥Êñá‰ª∂</h3>
                <button class="close-modal" id="close-upload-modal">&times;</button>
            </div>
            <div style="margin: 20px 0;">
                <div style="border: 2px dashed #ddd; padding: 40px; text-align: center; border-radius: 10px; margin-bottom: 20px;">
                    <i class="fas fa-cloud-upload-alt" style="font-size: 3rem; color: var(--primary-color); margin-bottom: 15px;"></i>
                    <p>ÊãñÊîæÊñá‰ª∂Âà∞ÈÄôË£°ÔºåÊàñÈªûÊìäÈÅ∏ÊìáÊñá‰ª∂</p>
                    <input type="file" id="file-input" multiple style="display: none;">
                    <button class="btn btn-primary" id="select-files-btn" style="margin-top: 10px;">
                        <i class="fas fa-folder-open"></i> ÈÅ∏ÊìáÊñá‰ª∂
                    </button>
                </div>
                
                <div id="upload-progress" style="display: none;">
                    <h4>‰∏äÂÇ≥ÈÄ≤Â∫¶</h4>
                    <div style="background-color: #eee; height: 10px; border-radius: 5px; margin: 10px 0;">
                        <div id="progress-bar" style="background-color: var(--primary-color); height: 100%; width: 0%; border-radius: 5px;"></div>
                    </div>
                    <p id="progress-text"></p>
                </div>
                
                <div id="uploaded-files" style="display: none;">
                    <h4>Â∑≤‰∏äÂÇ≥Êñá‰ª∂</h4>
                    <div id="uploaded-list"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ============================
        // Âç≥ÊôÇÊñá‰ª∂Á∑®ËºØÁ≥ªÁµ±
        // ============================
        
        const STORAGE_KEY = 'instant_file_editor';
        let currentData = null;
        let currentUser = null;
        let currentFileId = null;
        let isEditing = false;
        let autoSaveTimer = null;
        let syncStatus = 'saved'; // saved, saving, error
        
        // ÈªòË™çÊï∏Êìö
        const defaultData = {
            users: [
                {
                    id: 1,
                    username: 'admin',
                    fullname: 'Á≥ªÁµ±ÁÆ°ÁêÜÂì°',
                    role: 'admin',
                    status: 'active',
                    password: 'password123'
                }
            ],
            files: [
                {
                    id: 1,
                    name: 'Ê≠°Ëøé‰ΩøÁî®.txt',
                    type: 'txt',
                    content: '# Ê≠°Ëøé‰ΩøÁî®Âç≥ÊôÇÊñá‰ª∂Á∑®ËºØÁ≥ªÁµ±\n\nÈÄôÊòØ‰∏ÄÂÄãÁ∞°ÂñÆÊòìÁî®ÁöÑÊñá‰ª∂Á∑®ËºØÁ≥ªÁµ±ÔºåÂÖ∑Êúâ‰ª•‰∏ãÁâπÈªûÔºö\n\n1. üìù **ÈªûÊìäÂç≥Á∑®ËºØ** - ÈªûÊìä‰ªª‰ΩïÊñá‰ª∂Áõ¥Êé•ÈñãÂßãÁ∑®ËºØ\n2. üîÑ **Âç≥ÊôÇÂêåÊ≠•** - ÊâÄÊúâÊõ¥ÊîπËá™Âãï‰øùÂ≠òÂà∞ÁÄèË¶ΩÂô®\n3. üíæ **Â§öÊ†ºÂºèÊîØÊåÅ** - ÊîØÊåÅtxt, md, html, css, js, jsonÁ≠âÊ†ºÂºè\n4. üì± **ÈüøÊáâÂºèË®≠Ë®à** - Âú®ÂêÑÁ®ÆË®≠ÂÇô‰∏äÈÉΩËÉΩËâØÂ•ΩÂ∑•‰Ωú\n5. üîç **ÂØ¶ÊôÇÈ†êË¶Ω** - MarkdownÂíåHTMLÊñá‰ª∂ÊîØÊåÅÂØ¶ÊôÇÈ†êË¶Ω\n\n## Âø´ÈÄüÈñãÂßã\n1. ÈªûÊìäÂ∑¶ÂÅ¥„ÄåÊñ∞Âª∫Êñá‰ª∂„ÄçÂâµÂª∫Êñ∞Êñá‰ª∂\n2. ÈªûÊìä‰ªª‰ΩïÊñá‰ª∂ÈñãÂßãÁ∑®ËºØ\n3. Á≥ªÁµ±ÊúÉËá™Âãï‰øùÂ≠òÊÇ®ÁöÑÊõ¥Êîπ\n4. ‰ΩøÁî®È†êË¶ΩÂäüËÉΩÊü•ÁúãÊïàÊûú\n\nÈñãÂßãÂâµ‰ΩúÂêßÔºÅ',
                    size: '1.2 KB',
                    createdAt: new Date().toISOString(),
                    updatedAt: new Date().toISOString(),
                    createdBy: 'admin',
                    lastOpened: new Date().toISOString()
                },
                {
                    id: 2,
                    name: 'È†ÖÁõÆË®àÂäÉ.md',
                    type: 'md',
                    content: '# È†ÖÁõÆË®àÂäÉ\n\n## È†ÖÁõÆÊ¶ÇËø∞\nÈÄôÊòØ‰∏ÄÂÄãÁ§∫‰æãMarkdownÊñá‰ª∂ÔºåÂ±ïÁ§∫Á≥ªÁµ±ÁöÑÁ∑®ËºØÂäüËÉΩ„ÄÇ\n\n## ÂäüËÉΩÂàóË°®\n- [x] Êñá‰ª∂ÁÆ°ÁêÜ\n- [x] Âç≥ÊôÇÁ∑®ËºØ\n- [ ] Â§ö‰∫∫Âçî‰Ωú\n- [ ] ÁâàÊú¨ÊéßÂà∂\n\n## ‰ª£Á¢ºÁ§∫‰æã\n```javascript\n// ÈÄôÊòØ‰∏ÄÂÄãJavaScriptÁ§∫‰æã\nfunction hello() {\n    console.log("Hello, World!");\n}\n```\n\n## ÈÄ≤Â∫¶ËøΩËπ§\n| ‰ªªÂãô | ÁãÄÊÖã | Ë≤†Ë≤¨‰∫∫ |\n|------|------|--------|\n| Ë®≠Ë®à | ÂÆåÊàê | Âºµ‰∏â |\n| ÈñãÁôº | ÈÄ≤Ë°å‰∏≠ | ÊùéÂõõ |\n| Ê∏¨Ë©¶ | Êú™ÈñãÂßã | Áéã‰∫î |',
                    size: '2.1 KB',
                    createdAt: '2023-10-28T10:30:00',
                    updatedAt: '2023-10-28T14:20:00',
                    createdBy: 'admin',
                    lastOpened: null
                },
                {
                    id: 3,
                    name: 'Ê®£ÂºèË°®.css',
                    type: 'css',
                    content: '/* Á∂≤Á´ôÊ®£ÂºèË°® */\n\n:root {\n    --primary-color: #4361ee;\n    --secondary-color: #3a0ca3;\n    --success-color: #4cc9f0;\n    --danger-color: #f72585;\n    --warning-color: #f8961e;\n}\n\nbody {\n    font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;\n    line-height: 1.6;\n    color: #333;\n    background-color: #f8f9fa;\n}\n\n.container {\n    max-width: 1200px;\n    margin: 0 auto;\n    padding: 20px;\n}\n\n.btn {\n    padding: 10px 20px;\n    border-radius: 5px;\n    border: none;\n    cursor: pointer;\n    transition: all 0.3s;\n}\n\n.btn-primary {\n    background-color: var(--primary-color);\n    color: white;\n}\n\n.btn-primary:hover {\n    background-color: #3251d4;\n}',
                    size: '1.8 KB',
                    createdAt: '2023-10-27T09:15:00',
                    updatedAt: '2023-10-27T11:45:00',
                    createdBy: 'admin',
                    lastOpened: null
                }
            ],
            settings: {
                autoSave: true,
                autoSaveInterval: 3, // Áßí
                defaultFileType: 'txt'
            }
        };
        
        // ÂàùÂßãÂåñÁ≥ªÁµ±
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Á≥ªÁµ±ÂàùÂßãÂåñ...');
            
            // Âä†ËºâÊï∏Êìö
            loadData();
            
            // ÁôªÈåÑË°®ÂñÆ
            document.getElementById('login-form').addEventListener('submit', function(e) {
                e.preventDefault();
                login();
            });
            
            // ÂàùÂßãÂåñ‰∫ã‰ª∂Áõ£ËÅΩÂô®
            initEventListeners();
            
            console.log('Á≥ªÁµ±ÂàùÂßãÂåñÂÆåÊàê');
        });
        
        // Âä†ËºâÊï∏Êìö
        function loadData() {
            try {
                const savedData = localStorage.getItem(STORAGE_KEY);
                if (savedData) {
                    currentData = JSON.parse(savedData);
                    console.log('ÂæûÊú¨Âú∞Â≠òÂÑ≤Âä†ËºâÊï∏Êìö');
                } else {
                    currentData = JSON.parse(JSON.stringify(defaultData));
                    console.log('‰ΩøÁî®ÈªòË™çÊï∏Êìö');
                    saveData();
                }
            } catch (error) {
                console.error('Âä†ËºâÊï∏ÊìöÂ§±Êïó:', error);
                currentData = JSON.parse(JSON.stringify(defaultData));
                saveData();
            }
        }
        
        // ‰øùÂ≠òÊï∏Êìö
        function saveData() {
            try {
                localStorage.setItem(STORAGE_KEY, JSON.stringify(currentData));
                console.log('Êï∏Êìö‰øùÂ≠òÊàêÂäü');
                return true;
            } catch (error) {
                console.error('‰øùÂ≠òÊï∏ÊìöÂ§±Êïó:', error);
                updateSyncStatus('error');
                return false;
            }
        }
        
        // Áî®Êà∂ÁôªÈåÑ
        function login() {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            const user = currentData.users.find(u => 
                u.username === username && 
                u.password === password &&
                u.status === 'active'
            );
            
            if (user) {
                currentUser = { ...user };
                delete currentUser.password;
                
                // ÂàáÊèõÂà∞‰∏ªÁïåÈù¢
                document.getElementById('login-page').style.display = 'none';
                document.getElementById('app-page').style.display = 'block';
                
                // Êõ¥Êñ∞Áî®Êà∂ÁïåÈù¢
                updateUserInfo();
                
                // Âä†ËºâÊñá‰ª∂ÂàóË°®
                loadFileList();
                
                console.log('Áî®Êà∂ÁôªÈåÑÊàêÂäü:', currentUser.username);
            } else {
                alert('ÁôªÈåÑÂ§±ÊïóÔºÅË´ãÊ™¢Êü•Áî®Êà∂ÂêçÂíåÂØÜÁ¢º„ÄÇ\nÈªòË™çË≥¨ËôüÔºöadmin / password123');
            }
        }
        
        // ÂàùÂßãÂåñ‰∫ã‰ª∂Áõ£ËÅΩÂô®
        function initEventListeners() {
            // ÁôªÂá∫
            document.getElementById('logout-btn').addEventListener('click', logout);
            
            // Â∞éËà™ËèúÂñÆ
            document.querySelectorAll('.nav-links a[data-page]').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    // Êõ¥Êñ∞Ê¥ªÂãïÁãÄÊÖã
                    document.querySelectorAll('.nav-links a').forEach(item => {
                        item.classList.remove('active');
                    });
                    this.classList.add('active');
                    
                    // ÂàáÊèõÈ†ÅÈù¢
                    const pageId = this.getAttribute('data-page');
                    if (pageId === 'files') {
                        showFilesPage();
                    } else if (pageId === 'create') {
                        showNewFileModal();
                    } else if (pageId === 'backup') {
                        showBackupPage();
                    }
                });
            });
            
            // ËøîÂõûÊñá‰ª∂ÂàóË°®
            document.getElementById('back-to-files').addEventListener('click', showFilesPage);
            
            // ÊêúÁ¥¢Êñá‰ª∂
            document.getElementById('search-btn').addEventListener('click', searchFiles);
            document.getElementById('file-search').addEventListener('keyup', function(e) {
                if (e.key === 'Enter') searchFiles();
            });
            
            // ‰∏äÂÇ≥Êñá‰ª∂
            document.getElementById('upload-file-btn').addEventListener('click', showUploadModal);
            
            // Êñ∞Âª∫Êñá‰ª∂Ê®°ÊÖãÊ°Ü
            document.getElementById('close-new-file-modal').addEventListener('click', hideNewFileModal);
            document.getElementById('new-file-form').addEventListener('submit', createNewFile);
            
            // ‰∏äÂÇ≥Êñá‰ª∂Ê®°ÊÖãÊ°Ü
            document.getElementById('close-upload-modal').addEventListener('click', hideUploadModal);
            document.getElementById('select-files-btn').addEventListener('click', function() {
                document.getElementById('file-input').click();
            });
            document.getElementById('file-input').addEventListener('change', handleFileUpload);
            
            // Á∑®ËºØÂô®‰∫ã‰ª∂
            document.getElementById('save-btn').addEventListener('click', saveCurrentFile);
            document.getElementById('preview-toggle').addEventListener('click', togglePreview);
            document.getElementById('delete-file-btn').addEventListener('click', deleteCurrentFile);
            document.getElementById('download-file-btn').addEventListener('click', downloadCurrentFile);
            document.getElementById('duplicate-file-btn').addEventListener('click', duplicateCurrentFile);
            
            // Êñá‰ª∂ÈáçÂëΩÂêç
            document.getElementById('rename-file').addEventListener('input', function() {
                if (currentFileId) {
                    const file = currentData.files.find(f => f.id === currentFileId);
                    if (file && file.name !== this.value) {
                        file.name = this.value;
                        document.getElementById('editor-filename').textContent = this.value;
                        scheduleAutoSave();
                    }
                }
            });
            
            // Êñá‰ª∂È°ûÂûãÊõ¥Êîπ
            document.getElementById('change-file-type').addEventListener('change', function() {
                if (currentFileId) {
                    const file = currentData.files.find(f => f.id === currentFileId);
                    if (file && file.type !== this.value) {
                        file.type = this.value;
                        updateFileTypeBadge();
                        scheduleAutoSave();
                    }
                }
            });
            
            // Á∑®ËºØÂô®ÂÖßÂÆπËÆäÂåñ
            document.getElementById('editor-textarea').addEventListener('input', function() {
                if (currentFileId && !isEditing) {
                    isEditing = true;
                    scheduleAutoSave();
                }
            });
            
            // Ê†ºÂºèÂåñÊåâÈàï
            document.querySelectorAll('[data-format]').forEach(btn => {
                btn.addEventListener('click', function() {
                    applyFormat(this.dataset.format);
                });
            });
            
            // ÂÖ®Â±ÄÈªûÊìäÈóúÈñâÊ®°ÊÖãÊ°Ü
            window.addEventListener('click', function(e) {
                if (e.target.id === 'new-file-modal') hideNewFileModal();
                if (e.target.id === 'upload-file-modal') hideUploadModal();
            });
        }
        
        // Êõ¥Êñ∞Áî®Êà∂‰ø°ÊÅØ
        function updateUserInfo() {
            document.getElementById('user-name').textContent = currentUser.fullname;
            document.getElementById('user-avatar').textContent = currentUser.username.charAt(0).toUpperCase();
        }
        
        // È°ØÁ§∫Êñá‰ª∂ÂàóË°®È†ÅÈù¢
        function showFilesPage() {
            document.getElementById('files-page').classList.add('active');
            document.getElementById('editor-page').classList.remove('active');
            loadFileList();
        }
        
        // Âä†ËºâÊñá‰ª∂ÂàóË°®
        function loadFileList() {
            const filesGrid = document.getElementById('files-grid');
            filesGrid.innerHTML = '';
            
            // ÊåâÊúÄÂæå‰øÆÊîπÊôÇÈñìÊéíÂ∫è
            const sortedFiles = [...currentData.files].sort((a, b) => {
                return new Date(b.updatedAt) - new Date(a.updatedAt);
            });
            
            if (sortedFiles.length === 0) {
                filesGrid.innerHTML = `
                    <div style="grid-column: 1 / -1; text-align: center; padding: 60px 20px; color: var(--gray-color);">
                        <i class="fas fa-folder-open" style="font-size: 3rem; margin-bottom: 20px; display: block; opacity: 0.5;"></i>
                        <h3>Êö´ÁÑ°Êñá‰ª∂</h3>
                        <p>ÈªûÊìä„Äå‰∏äÂÇ≥Êñá‰ª∂„ÄçÊàñ„ÄåÊñ∞Âª∫Êñá‰ª∂„ÄçÈñãÂßã‰ΩøÁî®</p>
                    </div>
                `;
                return;
            }
            
            sortedFiles.forEach(file => {
                const fileCard = document.createElement('div');
                fileCard.className = 'file-card';
                if (file.id === currentFileId) {
                    fileCard.classList.add('active');
                }
                
                // Áç≤ÂèñÊñá‰ª∂ÂúñÊ®ô
                const fileIcon = getFileIcon(file.type);
                const fileTypeName = getFileTypeName(file.type);
                const fileSize = file.size || calculateFileSize(file.content);
                
                fileCard.innerHTML = `
                    <div class="file-icon ${file.type}">
                        <i class="${fileIcon}"></i>
                    </div>
                    <div class="file-info">
                        <h3 title="${file.name}">${file.name}</h3>
                        <p>${fileTypeName}</p>
                        <p>${fileSize}</p>
                        <p style="font-size: 0.8rem; color: #999;">
                            ${formatDate(file.updatedAt)}
                        </p>
                    </div>
                    <div class="file-actions">
                        <button class="action-btn" title="Á∑®ËºØ" onclick="openFileForEdit(${file.id})">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="action-btn" title="Âà™Èô§" onclick="deleteFile(${file.id})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `;
                
                // ÈªûÊìäÂç°ÁâáÊâìÈñãÁ∑®ËºØÂô®
                fileCard.addEventListener('click', function(e) {
                    if (!e.target.closest('.file-actions')) {
                        openFileForEdit(file.id);
                    }
                });
                
                filesGrid.appendChild(fileCard);
            });
        }
        
        // ÊêúÁ¥¢Êñá‰ª∂
        function searchFiles() {
            const searchTerm = document.getElementById('file-search').value.toLowerCase();
            const filesGrid = document.getElementById('files-grid');
            const fileCards = filesGrid.querySelectorAll('.file-card');
            
            fileCards.forEach(card => {
                const fileName = card.querySelector('h3').textContent.toLowerCase();
                if (fileName.includes(searchTerm)) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });
        }
        
        // ÊâìÈñãÊñá‰ª∂ÈÄ≤Ë°åÁ∑®ËºØ
        window.openFileForEdit = function(fileId) {
            const file = currentData.files.find(f => f.id === fileId);
            if (!file) return;
            
            currentFileId = fileId;
            
            // Êõ¥Êñ∞ÊúÄÂæåÊâìÈñãÊôÇÈñì
            file.lastOpened = new Date().toISOString();
            
            // ÂàáÊèõÂà∞Á∑®ËºØÂô®È†ÅÈù¢
            document.getElementById('files-page').classList.remove('active');
            document.getElementById('editor-page').classList.add('active');
            
            // Êõ¥Êñ∞Á∑®ËºØÂô®ÂÖßÂÆπ
            document.getElementById('editor-filename').textContent = file.name;
            document.getElementById('rename-file').value = file.name;
            document.getElementById('editor-textarea').value = file.content || '';
            document.getElementById('change-file-type').value = file.type;
            document.getElementById('last-modified').textContent = formatDate(file.updatedAt, true);
            document.getElementById('file-size-info').textContent = file.size || calculateFileSize(file.content);
            document.getElementById('file-created').textContent = formatDate(file.createdAt);
            
            // Êõ¥Êñ∞Êñá‰ª∂È°ûÂûãÊ®ôÁ±§
            updateFileTypeBadge();
            
            // ÈáçÁΩÆÂêåÊ≠•ÁãÄÊÖã
            updateSyncStatus('saved');
            
            // ÈáçÁΩÆÁ∑®ËºØÁãÄÊÖã
            isEditing = false;
            
            // Âä†ËºâÈ†êË¶ΩÔºàÂ¶ÇÊûúÊòØMarkdownÊàñHTMLÔºâ
            if (file.type === 'md' || file.type === 'html') {
                updatePreview();
            }
            
            console.log('ÊâìÈñãÊñá‰ª∂ÈÄ≤Ë°åÁ∑®ËºØ:', file.name);
        };
        
        // ‰øùÂ≠òÁï∂ÂâçÊñá‰ª∂
        function saveCurrentFile() {
            if (!currentFileId) return;
            
            const file = currentData.files.find(f => f.id === currentFileId);
            if (!file) return;
            
            updateSyncStatus('saving');
            
            // Êõ¥Êñ∞Êñá‰ª∂ÂÖßÂÆπ
            file.content = document.getElementById('editor-textarea').value;
            file.updatedAt = new Date().toISOString();
            file.size = calculateFileSize(file.content);
            
            // ‰øùÂ≠òÂà∞Êú¨Âú∞Â≠òÂÑ≤
            if (saveData()) {
                updateSyncStatus('saved');
                
                // Êõ¥Êñ∞ÁïåÈù¢
                document.getElementById('last-modified').textContent = formatDate(file.updatedAt, true);
                document.getElementById('file-size-info').textContent = file.size;
                
                // Êõ¥Êñ∞Êñá‰ª∂ÂàóË°®‰∏≠ÁöÑÊñá‰ª∂Âç°Áâá
                updateFileCard(file.id);
                
                console.log('Êñá‰ª∂‰øùÂ≠òÊàêÂäü:', file.name);
            }
            
            isEditing = false;
        }
        
        // Âà™Èô§Áï∂ÂâçÊñá‰ª∂
        function deleteCurrentFile() {
            if (!currentFileId) return;
            
            const file = currentData.files.find(f => f.id === currentFileId);
            if (!file) return;
            
            if (confirm(`Á¢∫ÂÆöË¶ÅÂà™Èô§Êñá‰ª∂ "${file.name}" ÂóéÔºüÊ≠§Êìç‰ΩúÁÑ°Ê≥ïÊí§Èä∑„ÄÇ`)) {
                const fileIndex = currentData.files.findIndex(f => f.id === currentFileId);
                currentData.files.splice(fileIndex, 1);
                saveData();
                
                // ËøîÂõûÊñá‰ª∂ÂàóË°®
                showFilesPage();
                
                alert('Êñá‰ª∂Â∑≤Âà™Èô§ÔºÅ');
            }
        }
        
        // Âà™Èô§Êñá‰ª∂ÔºàÂæûÊñá‰ª∂ÂàóË°®Ôºâ
        window.deleteFile = function(fileId) {
            event.stopPropagation();
            
            const file = currentData.files.find(f => f.id === fileId);
            if (!file) return;
            
            if (confirm(`Á¢∫ÂÆöË¶ÅÂà™Èô§Êñá‰ª∂ "${file.name}" ÂóéÔºü`)) {
                const fileIndex = currentData.files.findIndex(f => f.id === fileId);
                currentData.files.splice(fileIndex, 1);
                saveData();
                loadFileList();
                
                // Â¶ÇÊûúÂà™Èô§ÁöÑÊòØÁï∂ÂâçÊ≠£Âú®Á∑®ËºØÁöÑÊñá‰ª∂ÔºåËøîÂõûÊñá‰ª∂ÂàóË°®
                if (fileId === currentFileId) {
                    showFilesPage();
                }
            }
        };
        
        // ‰∏ãËºâÁï∂ÂâçÊñá‰ª∂
        function downloadCurrentFile() {
            if (!currentFileId) return;
            
            const file = currentData.files.find(f => f.id === currentFileId);
            if (!file) return;
            
            const content = file.content;
            const fileName = `${file.name}.${file.type}`;
            
            const blob = new Blob([content], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = fileName;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            alert(`Êñá‰ª∂ "${fileName}" Â∑≤ÈñãÂßã‰∏ãËºâ`);
        }
        
        // Ë§áË£ΩÁï∂ÂâçÊñá‰ª∂
        function duplicateCurrentFile() {
            if (!currentFileId) return;
            
            const file = currentData.files.find(f => f.id === currentFileId);
            if (!file) return;
            
            const newFile = {
                id: Date.now(),
                name: `ÂâØÊú¨_${file.name}`,
                type: file.type,
                content: file.content,
                size: file.size,
                createdAt: new Date().toISOString(),
                updatedAt: new Date().toISOString(),
                createdBy: currentUser.username,
                lastOpened: null
            };
            
            currentData.files.unshift(newFile);
            saveData();
            
            // ÊâìÈñãÊñ∞Êñá‰ª∂ÈÄ≤Ë°åÁ∑®ËºØ
            openFileForEdit(newFile.id);
            
            alert('Êñá‰ª∂Â∑≤Ë§áË£ΩÔºÅ');
        }
        
        // ÂàáÊèõÈ†êË¶Ω
        function togglePreview() {
            const textarea = document.getElementById('editor-textarea');
            const previewArea = document.getElementById('preview-area');
            const previewToggle = document.getElementById('preview-toggle');
            
            if (previewArea.style.display === 'none') {
                // Êõ¥Êñ∞È†êË¶ΩÂÖßÂÆπ
                updatePreview();
                
                // ÂàáÊèõÂà∞È†êË¶ΩÊ®°Âºè
                textarea.style.display = 'none';
                previewArea.style.display = 'block';
                previewToggle.innerHTML = '<i class="fas fa-edit"></i> Á∑®ËºØ';
            } else {
                // ÂàáÊèõÂõûÁ∑®ËºØÊ®°Âºè
                textarea.style.display = 'block';
                previewArea.style.display = 'none';
                previewToggle.innerHTML = '<i class="fas fa-eye"></i> È†êË¶Ω';
            }
        }
        
        // Êõ¥Êñ∞È†êË¶Ω
        function updatePreview() {
            const file = currentData.files.find(f => f.id === currentFileId);
            if (!file) return;
            
            const previewContent = document.getElementById('preview-content');
            
            if (file.type === 'md') {
                previewContent.innerHTML = markdownToHTML(file.content);
            } else if (file.type === 'html') {
                previewContent.innerHTML = file.content;
            } else {
                previewContent.innerHTML = `<pre>${escapeHtml(file.content)}</pre>`;
            }
        }
        
        // ÂÆâÊéíËá™Âãï‰øùÂ≠ò
        function scheduleAutoSave() {
            if (!currentData.settings.autoSave) return;
            
            updateSyncStatus('saving');
            
            // Ê∏ÖÈô§‰πãÂâçÁöÑË®àÊôÇÂô®
            if (autoSaveTimer) {
                clearTimeout(autoSaveTimer);
            }
            
            // Ë®≠ÁΩÆÊñ∞ÁöÑË®àÊôÇÂô®
            autoSaveTimer = setTimeout(() => {
                saveCurrentFile();
            }, currentData.settings.autoSaveInterval * 1000);
        }
        
        // Êõ¥Êñ∞ÂêåÊ≠•ÁãÄÊÖã
        function updateSyncStatus(status) {
            syncStatus = status;
            const syncDot = document.getElementById('sync-status');
            const syncText = document.getElementById('sync-text');
            
            syncDot.className = 'sync-dot';
            
            switch (status) {
                case 'saved':
                    syncDot.classList.add('sync-saved');
                    syncText.textContent = 'Â∑≤ÂêåÊ≠•';
                    break;
                case 'saving':
                    syncDot.classList.add('sync-saving');
                    syncText.textContent = 'ÂêåÊ≠•‰∏≠...';
                    break;
                case 'error':
                    syncDot.classList.add('sync-error');
                    syncText.textContent = 'ÂêåÊ≠•Â§±Êïó';
                    break;
            }
        }
        
        // Êõ¥Êñ∞Êñá‰ª∂È°ûÂûãÊ®ôÁ±§
        function updateFileTypeBadge() {
            if (!currentFileId) return;
            
            const file = currentData.files.find(f => f.id === currentFileId);
            if (!file) return;
            
            const badge = document.getElementById('file-type-badge');
            badge.textContent = file.type.toUpperCase();
            badge.className = 'file-type-badge';
            badge.classList.add(`badge-${file.type}`);
        }
        
        // Êõ¥Êñ∞Êñá‰ª∂Âç°Áâá
        function updateFileCard(fileId) {
            const file = currentData.files.find(f => f.id === fileId);
            if (!file) return;
            
            // ÈÄôË£°ÂèØ‰ª•ÂØ¶ÁèæÊõ¥Êñ∞Êñá‰ª∂ÂàóË°®‰∏≠ÁâπÂÆöÂç°ÁâáÁöÑÈÇèËºØ
            // ÁÇ∫‰∫ÜÁ∞°ÂñÆËµ∑Ë¶ãÔºåÊàëÂÄëÈáçÊñ∞Âä†ËºâÊï¥ÂÄãÂàóË°®
            loadFileList();
        }
        
        // È°ØÁ§∫Êñ∞Âª∫Êñá‰ª∂Ê®°ÊÖãÊ°Ü
        function showNewFileModal() {
            document.getElementById('new-file-modal').classList.add('active');
            document.getElementById('new-file-name').focus();
        }
        
        // Èö±ËóèÊñ∞Âª∫Êñá‰ª∂Ê®°ÊÖãÊ°Ü
        function hideNewFileModal() {
            document.getElementById('new-file-modal').classList.remove('active');
            document.getElementById('new-file-form').reset();
        }
        
        // ÂâµÂª∫Êñ∞Êñá‰ª∂
        function createNewFile(e) {
            e.preventDefault();
            
            const fileName = document.getElementById('new-file-name').value;
            const fileType = document.getElementById('new-file-type').value;
            const fileContent = document.getElementById('new-file-content').value;
            
            const newFile = {
                id: Date.now(),
                name: fileName,
                type: fileType,
                content: fileContent || '',
                size: calculateFileSize(fileContent),
                createdAt: new Date().toISOString(),
                updatedAt: new Date().toISOString(),
                createdBy: currentUser.username,
                lastOpened: null
            };
            
            currentData.files.unshift(newFile);
            saveData();
            
            // ÊâìÈñãÊñ∞Êñá‰ª∂ÈÄ≤Ë°åÁ∑®ËºØ
            openFileForEdit(newFile.id);
            
            hideNewFileModal();
        }
        
        // È°ØÁ§∫‰∏äÂÇ≥Êñá‰ª∂Ê®°ÊÖãÊ°Ü
        function showUploadModal() {
            document.getElementById('upload-file-modal').classList.add('active');
        }
        
        // Èö±Ëóè‰∏äÂÇ≥Êñá‰ª∂Ê®°ÊÖãÊ°Ü
        function hideUploadModal() {
            document.getElementById('upload-file-modal').classList.remove('active');
            document.getElementById('upload-progress').style.display = 'none';
            document.getElementById('uploaded-files').style.display = 'none';
            document.getElementById('file-input').value = '';
        }
        
        // ËôïÁêÜÊñá‰ª∂‰∏äÂÇ≥
        function handleFileUpload(e) {
            const files = e.target.files;
            if (files.length === 0) return;
            
            const uploadProgress = document.getElementById('upload-progress');
            const progressBar = document.getElementById('progress-bar');
            const progressText = document.getElementById('progress-text');
            const uploadedList = document.getElementById('uploaded-list');
            
            uploadProgress.style.display = 'block';
            uploadedList.innerHTML = '';
            
            let uploadedCount = 0;
            const totalFiles = files.length;
            
            Array.from(files).forEach((file, index) => {
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    uploadedCount++;
                    
                    // Êõ¥Êñ∞ÈÄ≤Â∫¶
                    const progress = (uploadedCount / totalFiles) * 100;
                    progressBar.style.width = `${progress}%`;
                    progressText.textContent = `Ê≠£Âú®ËôïÁêÜ ${uploadedCount}/${totalFiles}: ${file.name}`;
                    
                    // Á¢∫ÂÆöÊñá‰ª∂È°ûÂûã
                    const fileExt = file.name.split('.').pop().toLowerCase();
                    let fileType = 'txt';
                    if (['md', 'markdown'].includes(fileExt)) fileType = 'md';
                    else if (fileExt === 'html') fileType = 'html';
                    else if (fileExt === 'css') fileType = 'css';
                    else if (fileExt === 'js') fileType = 'js';
                    else if (fileExt === 'json') fileType = 'json';
                    else if (['txt', 'text'].includes(fileExt)) fileType = 'txt';
                    
                    // ÂâµÂª∫Êñá‰ª∂Â∞çË±°
                    const newFile = {
                        id: Date.now() + index,
                        name: file.name,
                        type: fileType,
                        content: e.target.result,
                        size: formatFileSize(file.size),
                        createdAt: new Date().toISOString(),
                        updatedAt: new Date().toISOString(),
                        createdBy: currentUser.username,
                        lastOpened: null
                    };
                    
                    currentData.files.unshift(newFile);
                    
                    // Ê∑ªÂä†Âà∞‰∏äÂÇ≥ÂàóË°®
                    const fileItem = document.createElement('div');
                    fileItem.style.padding = '10px';
                    fileItem.style.borderBottom = '1px solid #eee';
                    fileItem.innerHTML = `
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <i class="${getFileIcon(fileType)}" style="color: #4361ee;"></i>
                            <div>
                                <div>${file.name}</div>
                                <div style="font-size: 0.8rem; color: #666;">${formatFileSize(file.size)} ‚Ä¢ ‰∏äÂÇ≥ÊàêÂäü</div>
                            </div>
                        </div>
                    `;
                    uploadedList.appendChild(fileItem);
                    
                    if (uploadedCount === totalFiles) {
                        progressText.textContent = 'ËôïÁêÜÂÆåÊàêÔºÅ';
                        
                        // ‰øùÂ≠òÊï∏Êìö
                        saveData();
                        
                        // È°ØÁ§∫‰∏äÂÇ≥ÁöÑÊñá‰ª∂
                        document.getElementById('uploaded-files').style.display = 'block';
                        
                        // 2ÁßíÂæåÈóúÈñâÊ®°ÊÖãÊ°Ü‰∏¶Âà∑Êñ∞Êñá‰ª∂ÂàóË°®
                        setTimeout(() => {
                            hideUploadModal();
                            loadFileList();
                        }, 2000);
                    }
                };
                
                reader.readAsText(file);
            });
        }
        
        // ÊáâÁî®Ê†ºÂºè
        function applyFormat(format) {
            const textarea = document.getElementById('editor-textarea');
            const start = textarea.selectionStart;
            const end = textarea.selectionEnd;
            const selectedText = textarea.value.substring(start, end);
            
            let formattedText = '';
            let cursorOffset = 0;
            
            switch (format) {
                case 'bold':
                    formattedText = `**${selectedText || 'Á≤óÈ´îÊñáÂ≠ó'}**`;
                    cursorOffset = selectedText ? 0 : 2;
                    break;
                case 'italic':
                    formattedText = `*${selectedText || 'ÊñúÈ´îÊñáÂ≠ó'}*`;
                    cursorOffset = selectedText ? 0 : 1;
                    break;
                case 'code':
                    formattedText = `\`${selectedText || '‰ª£Á¢º'}\``;
                    cursorOffset = selectedText ? 0 : 1;
                    break;
                case 'link':
                    formattedText = `[${selectedText || 'ÈèàÊé•ÊñáÂ≠ó'}](https://example.com)`;
                    cursorOffset = selectedText ? 0 : 1;
                    break;
                case 'list':
                    formattedText = `- ${selectedText || 'ÂàóË°®È†Ö'}`;
                    cursorOffset = selectedText ? 0 : 2;
                    break;
                case 'heading':
                    formattedText = `## ${selectedText || 'Ê®ôÈ°å'}`;
                    cursorOffset = selectedText ? 0 : 3;
                    break;
            }
            
            // ÊèíÂÖ•Ê†ºÂºèÂåñÁöÑÊñáÊú¨
            textarea.value = textarea.value.substring(0, start) + 
                            formattedText + 
                            textarea.value.substring(end);
            
            // Êõ¥Êñ∞ÂÖâÊ®ô‰ΩçÁΩÆ
            const newCursorPos = start + formattedText.length - cursorOffset;
            textarea.focus();
            textarea.setSelectionRange(newCursorPos, newCursorPos);
            
            // Ëß∏ÁôºËá™Âãï‰øùÂ≠ò
            textarea.dispatchEvent(new Event('input'));
        }
        
        // È°ØÁ§∫ÂÇô‰ªΩÈ†ÅÈù¢ÔºàÁ∞°ÂñÆÂØ¶ÁèæÔºâ
        function showBackupPage() {
            if (confirm('Â∞éÂá∫ÊâÄÊúâÊï∏ÊìöÂà∞JSONÊñá‰ª∂Ôºü')) {
                exportAllData();
            }
        }
        
        // Â∞éÂá∫ÊâÄÊúâÊï∏Êìö
        function exportAllData() {
            try {
                const dataStr = JSON.stringify(currentData, null, 2);
                const blob = new Blob([dataStr], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                
                const a = document.createElement('a');
                a.href = url;
                a.download = `file-editor-backup-${new Date().toISOString().split('T')[0]}.json`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                alert('Êï∏ÊìöÂÇô‰ªΩÊàêÂäüÔºÅ');
            } catch (error) {
                console.error('Â∞éÂá∫Êï∏ÊìöÂ§±Êïó:', error);
                alert('Â∞éÂá∫Êï∏ÊìöÂ§±ÊïóÔºÅ');
            }
        }
        
        // Áî®Êà∂ÁôªÂá∫
        function logout() {
            if (confirm('Á¢∫ÂÆöË¶ÅÈÄÄÂá∫Á≥ªÁµ±ÂóéÔºü')) {
                // ‰øùÂ≠òÁï∂ÂâçÊñá‰ª∂
                if (currentFileId && isEditing) {
                    saveCurrentFile();
                }
                
                // ÈáçÁΩÆÁãÄÊÖã
                currentUser = null;
                currentFileId = null;
                
                // ÂàáÊèõÂà∞ÁôªÈåÑÈ†ÅÈù¢
                document.getElementById('app-page').style.display = 'none';
                document.getElementById('login-page').style.display = 'flex';
                
                console.log('Áî®Êà∂Â∑≤ÁôªÂá∫');
            }
        }
        
        // Â∑•ÂÖ∑ÂáΩÊï∏
        function getFileIcon(fileType) {
            const icons = {
                'txt': 'fas fa-file-alt',
                'md': 'fas fa-file-code',
                'html': 'fas fa-code',
                'css': 'fas fa-palette',
                'js': 'fas fa-code',
                'json': 'fas fa-database',
                'pdf': 'fas fa-file-pdf',
                'doc': 'fas fa-file-word',
                'img': 'fas fa-file-image'
            };
            return icons[fileType] || 'fas fa-file';
        }
        
        function getFileTypeName(fileType) {
            const names = {
                'txt': 'Á¥îÊñáÊú¨',
                'md': 'Markdown',
                'html': 'HTMLÊñá‰ª∂',
                'css': 'Ê®£ÂºèË°®',
                'js': 'JavaScript',
                'json': 'JSONÊï∏Êìö',
                'pdf': 'PDFÊñáÊ™î',
                'doc': 'WordÊñáÊ™î',
                'img': 'ÂúñÁâáÊñá‰ª∂'
            };
            return names[fileType] || 'Êñá‰ª∂';
        }
        
        function calculateFileSize(content) {
            if (!content) return '0 KB';
            const bytes = new Blob([content]).size;
            return formatFileSize(bytes);
        }
        
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
        }
        
        function formatDate(dateString, showTime = false) {
            if (!dateString) return 'Êú™Áü•';
            const date = new Date(dateString);
            
            if (showTime) {
                return date.toLocaleString('zh-CN');
            } else {
                const now = new Date();
                const diff = now - date;
                const diffMinutes = Math.floor(diff / (1000 * 60));
                const diffHours = Math.floor(diff / (1000 * 60 * 60));
                const diffDays = Math.floor(diff / (1000 * 60 * 60 * 24));
                
                if (diffMinutes < 1) return 'ÂâõÂâõ';
                if (diffMinutes < 60) return `${diffMinutes}ÂàÜÈêòÂâç`;
                if (diffHours < 24) return `${diffHours}Â∞èÊôÇÂâç`;
                if (diffDays < 7) return `${diffDays}Â§©Ââç`;
                return date.toLocaleDateString('zh-CN');
            }
        }
        
        function markdownToHTML(markdown) {
            let html = markdown;
            
            // Ê®ôÈ°å
            html = html.replace(/^# (.*$)/gm, '<h1>$1</h1>');
            html = html.replace(/^## (.*$)/gm, '<h2>$1</h2>');
            html = html.replace(/^### (.*$)/gm, '<h3>$1</h3>');
            
            // Á≤óÈ´î
            html = html.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
            
            // ÊñúÈ´î
            html = html.replace(/\*(.*?)\*/g, '<em>$1</em>');
            
            // Ë°åÂÖß‰ª£Á¢º
            html = html.replace(/`(.*?)`/g, '<code>$1</code>');
            
            // ‰ª£Á¢ºÂ°ä
            html = html.replace(/```([\s\S]*?)```/g, '<pre><code>$1</code></pre>');
            
            // ÁÑ°Â∫èÂàóË°®
            html = html.replace(/^- (.*$)/gm, '<li>$1</li>');
            html = html.replace(/(<li>.*<\/li>)/gs, '<ul>$1</ul>');
            
            // ÊúâÂ∫èÂàóË°®
            html = html.replace(/^\d+\. (.*$)/gm, '<li>$1</li>');
            html = html.replace(/(<li>.*<\/li>)/gs, '<ol>$1</ol>');
            
            // ÈèàÊé•
            html = html.replace(/\[(.*?)\]\((.*?)\)/g, '<a href="$2" target="_blank">$1</a>');
            
            // Ê∞¥Âπ≥Á∑ö
            html = html.replace(/^-{3,}$/gm, '<hr>');
            
            // ÊÆµËêΩÔºàËôïÁêÜÂâ©È§òÁöÑË°åÔºâ
            const lines = html.split('\n');
            let inList = false;
            let result = [];
            
            lines.forEach(line => {
                if (line.startsWith('<') || line === '') {
                    result.push(line);
                } else {
                    result.push(`<p>${line}</p>`);
                }
            });
            
            return result.join('\n');
        }
        
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
    </script>
</body>
</html>
