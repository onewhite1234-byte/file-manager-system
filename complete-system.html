<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å®Œæ•´æ–‡ä»¶ç®¡ç†ç³»çµ± | åŒ…å«ç·šä¸Šç·¨è¼¯</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* åŸºç¤æ¨£å¼ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        :root {
            --primary-color: #4361ee;
            --secondary-color: #3a0ca3;
            --success-color: #4cc9f0;
            --danger-color: #f72585;
            --warning-color: #f8961e;
            --light-color: #f8f9fa;
            --dark-color: #212529;
            --gray-color: #6c757d;
            --sidebar-width: 280px;
        }

        body {
            background-color: #f5f7fb;
            color: var(--dark-color);
            height: 100vh;
            overflow: hidden;
        }

        /* ç™»éŒ„é é¢ */
        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            padding: 20px;
        }

        .login-box {
            background-color: white;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 450px;
            padding: 40px;
        }

        .login-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .login-header h1 {
            color: var(--primary-color);
            font-size: 2.2rem;
            margin-bottom: 10px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }

        .form-control:focus {
            border-color: var(--primary-color);
            outline: none;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background-color: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background-color: #3251d4;
        }

        .btn-success {
            background-color: var(--success-color);
            color: white;
        }

        .btn-danger {
            background-color: var(--danger-color);
            color: white;
        }

        .btn-warning {
            background-color: var(--warning-color);
            color: white;
        }

        .btn-block {
            width: 100%;
            padding: 14px;
        }

        /* ä¸»æ‡‰ç”¨ä½ˆå±€ */
        #app-page {
            display: none;
            height: 100vh;
        }

        .app-container {
            display: flex;
            height: 100%;
        }

        /* å´é‚Šæ¬„ */
        .sidebar {
            width: var(--sidebar-width);
            background: linear-gradient(180deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 20px 0;
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        .sidebar-header {
            padding: 0 20px 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 20px;
        }

        .sidebar-header h2 {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.5rem;
        }

        .nav-links {
            list-style: none;
            flex: 1;
        }

        .nav-links li {
            margin-bottom: 5px;
        }

        .nav-links a {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 15px 20px;
            color: rgba(255, 255, 255, 0.9);
            text-decoration: none;
            transition: all 0.3s;
            font-size: 1rem;
        }

        .nav-links a:hover, .nav-links a.active {
            background-color: rgba(255, 255, 255, 0.1);
            color: white;
            border-left: 4px solid var(--success-color);
        }

        /* ä¸»å…§å®¹å€ */
        .main-content {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: white;
            padding: 15px 25px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            margin-bottom: 30px;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .user-avatar {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background-color: var(--primary-color);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 1.2rem;
        }

        /* å…§å®¹å¡ç‰‡ */
        .content-card {
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            padding: 25px;
            margin-bottom: 30px;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .card-header h2 {
            font-size: 1.5rem;
            color: var(--dark-color);
        }

        .card-header h2 i {
            margin-right: 10px;
            color: var(--primary-color);
        }

        /* å„€è¡¨æ¿çµ±è¨ˆ */
        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background-color: white;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .stat-icon {
            width: 60px;
            height: 60px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            color: white;
        }

        .stat-icon.files {
            background-color: var(--primary-color);
        }

        .stat-icon.users {
            background-color: var(--success-color);
        }

        .stat-icon.storage {
            background-color: var(--warning-color);
        }

        /* è¡¨æ ¼æ¨£å¼ */
        .table-container {
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }

        thead {
            background-color: #f8f9fa;
        }

        th {
            padding: 15px;
            text-align: left;
            font-weight: 600;
            color: var(--dark-color);
            border-bottom: 2px solid #e9ecef;
        }

        td {
            padding: 15px;
            border-bottom: 1px solid #e9ecef;
        }

        tbody tr:hover {
            background-color: #f8f9fa;
        }

        .file-icon {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
            color: white;
        }

        .file-icon.pdf { background-color: #ff6b6b; }
        .file-icon.doc { background-color: #4d96ff; }
        .file-icon.img { background-color: #6bcf7f; }
        .file-icon.zip { background-color: #ffd166; }
        .file-icon.txt { background-color: #9d9d9d; }

        .file-info {
            display: flex;
            align-items: center;
        }

        .file-actions {
            display: flex;
            gap: 10px;
        }

        .action-btn {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1.1rem;
            color: var(--gray-color);
            transition: color 0.3s;
        }

        .action-btn:hover {
            color: var(--primary-color);
        }

        /* æ–‡ä»¶ä¸Šå‚³å€åŸŸ */
        .upload-area {
            border: 2px dashed #ddd;
            border-radius: 10px;
            padding: 40px 20px;
            text-align: center;
            margin-bottom: 30px;
            transition: border-color 0.3s;
        }

        .upload-area:hover, .upload-area.dragover {
            border-color: var(--primary-color);
        }

        /* ç·šä¸Šç·¨è¼¯å™¨æ¨£å¼ */
        .editor-container {
            display: flex;
            flex-direction: column;
            height: 600px;
            border: 1px solid #e9ecef;
            border-radius: 10px;
            overflow: hidden;
            background: white;
        }

        .editor-toolbar {
            padding: 10px 20px;
            background: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .editor-content {
            flex: 1;
            position: relative;
        }

        #editor-textarea {
            width: 100%;
            height: 100%;
            border: none;
            outline: none;
            resize: none;
            font-size: 1rem;
            line-height: 1.6;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            padding: 20px;
        }

        #preview-area {
            width: 100%;
            height: 100%;
            padding: 20px;
            overflow-y: auto;
            background: white;
            display: none;
        }

        .editor-status {
            padding: 10px 20px;
            background: #f8f9fa;
            border-top: 1px solid #e9ecef;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .save-status {
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
        }

        .saved { background-color: #d4edda; color: #155724; }
        .unsaved { background-color: #fff3cd; color: #856404; }

        /* æœç´¢æ¡† */
        .search-box {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .search-input {
            flex: 1;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
        }

        /* é é¢åˆ‡æ› */
        .page {
            display: none;
            animation: fadeIn 0.5s;
        }

        .page.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* æ¨¡æ…‹æ¡† */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background-color: white;
            border-radius: 10px;
            width: 90%;
            max-width: 500px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--gray-color);
        }

        /* éŸ¿æ‡‰å¼è¨­è¨ˆ */
        @media (max-width: 992px) {
            .app-container {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                height: auto;
            }
            
            .nav-links {
                display: flex;
                overflow-x: auto;
            }
            
            .nav-links li {
                flex-shrink: 0;
            }
        }
    </style>
</head>
<body>
    <!-- ç™»éŒ„é é¢ -->
    <div id="login-page" class="login-container">
        <div class="login-box">
            <div class="login-header">
                <h1><i class="fas fa-cloud-upload-alt"></i> å®Œæ•´æ–‡ä»¶ç®¡ç†ç³»çµ±</h1>
                <p>æ–‡ä»¶ç®¡ç† + ç·šä¸Šç·¨è¼¯ äºŒåˆä¸€ç³»çµ±</p>
            </div>
            
            <form id="login-form">
                <div class="form-group">
                    <input type="text" id="username" class="form-control" placeholder="ç”¨æˆ¶å" value="admin" required>
                </div>
                <div class="form-group">
                    <input type="password" id="password" class="form-control" placeholder="å¯†ç¢¼" value="password123" required>
                </div>
                <button type="submit" class="btn btn-primary btn-block">
                    <i class="fas fa-sign-in-alt"></i> é€²å…¥ç³»çµ±
                </button>
            </form>
            
            <div style="margin-top: 20px; text-align: center; color: var(--gray-color); font-size: 0.9rem;">
                <p>æ¼”ç¤ºè³¬è™Ÿ: admin / password123</p>
                <p>æ‰€æœ‰æ•¸æ“šä¿å­˜åœ¨ç€è¦½å™¨ä¸­</p>
            </div>
        </div>
    </div>

    <!-- ä¸»æ‡‰ç”¨é é¢ -->
    <div id="app-page">
        <div class="app-container">
            <!-- å´é‚Šæ¬„ -->
            <aside class="sidebar">
                <div class="sidebar-header">
                    <h2><i class="fas fa-cloud"></i> æ–‡ä»¶ç®¡ç†</h2>
                </div>
                
                <ul class="nav-links">
                    <li><a href="#" class="active" data-page="dashboard"><i class="fas fa-home"></i> æ§åˆ¶é¢æ¿</a></li>
                    <li><a href="#" data-page="files"><i class="fas fa-folder"></i> æ‰€æœ‰æ–‡ä»¶</a></li>
                    <li><a href="#" data-page="upload"><i class="fas fa-upload"></i> ä¸Šå‚³æ–‡ä»¶</a></li>
                    <li><a href="#" data-page="editor"><i class="fas fa-edit"></i> ç·šä¸Šç·¨è¼¯</a></li>
                    <li><a href="#" data-page="users"><i class="fas fa-users"></i> ç”¨æˆ¶ç®¡ç†</a></li>
                    <li><a href="#" data-page="backup"><i class="fas fa-database"></i> æ•¸æ“šå‚™ä»½</a></li>
                </ul>
            </aside>

            <!-- ä¸»å…§å®¹å€ -->
            <main class="main-content">
                <header>
                    <div>
                        <h1 id="page-title">æ§åˆ¶é¢æ¿</h1>
                        <p id="page-description">æ­¡è¿ä½¿ç”¨å®Œæ•´æ–‡ä»¶ç®¡ç†ç³»çµ±</p>
                    </div>
                    
                    <div class="user-info">
                        <div class="user-avatar" id="user-avatar">A</div>
                        <div>
                            <div id="user-name">ç®¡ç†å“¡</div>
                            <div id="user-role">ç³»çµ±ç®¡ç†å“¡</div>
                        </div>
                        <button class="btn btn-danger" id="logout-btn">
                            <i class="fas fa-sign-out-alt"></i> é€€å‡º
                        </button>
                    </div>
                </header>

                <!-- æ§åˆ¶é¢æ¿é é¢ -->
                <div id="dashboard-page" class="page active">
                    <div class="stats-container">
                        <div class="stat-card">
                            <div class="stat-icon files">
                                <i class="fas fa-file"></i>
                            </div>
                            <div>
                                <h3 id="total-files">0</h3>
                                <p>æ–‡ä»¶ç¸½æ•¸</p>
                            </div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon users">
                                <i class="fas fa-users"></i>
                            </div>
                            <div>
                                <h3 id="total-users">0</h3>
                                <p>ç”¨æˆ¶ç¸½æ•¸</p>
                            </div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon storage">
                                <i class="fas fa-hdd"></i>
                            </div>
                            <div>
                                <h3 id="total-storage">0 MB</h3>
                                <p>å·²ç”¨å­˜å„²</p>
                            </div>
                        </div>
                    </div>

                    <div class="content-card">
                        <div class="card-header">
                            <h2><i class="fas fa-history"></i> æœ€è¿‘æ–‡ä»¶</h2>
                            <button class="btn btn-primary" id="view-all-files">
                                <i class="fas fa-eye"></i> æŸ¥çœ‹æ‰€æœ‰
                            </button>
                        </div>
                        
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>æ–‡ä»¶å</th>
                                        <th>é¡å‹</th>
                                        <th>å¤§å°</th>
                                        <th>ä¸Šå‚³æ™‚é–“</th>
                                        <th>æ“ä½œ</th>
                                    </tr>
                                </thead>
                                <tbody id="recent-files">
                                    <tr>
                                        <td colspan="5" style="text-align: center; padding: 40px; color: var(--gray-color);">
                                            <i class="fas fa-folder-open" style="font-size: 2rem; margin-bottom: 15px; display: block;"></i>
                                            æš«ç„¡æ–‡ä»¶
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- æ–‡ä»¶ç®¡ç†é é¢ -->
                <div id="files-page" class="page">
                    <div class="content-card">
                        <div class="card-header">
                            <h2><i class="fas fa-folder"></i> æ‰€æœ‰æ–‡ä»¶</h2>
                            <div class="search-box">
                                <input type="text" class="search-input" id="file-search" placeholder="æœç´¢æ–‡ä»¶å...">
                                <button class="btn btn-primary" id="search-files">
                                    <i class="fas fa-search"></i> æœç´¢
                                </button>
                            </div>
                        </div>
                        
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>æ–‡ä»¶å</th>
                                        <th>é¡å‹</th>
                                        <th>å¤§å°</th>
                                        <th>ä¸Šå‚³æ™‚é–“</th>
                                        <th>æ“ä½œ</th>
                                    </tr>
                                </thead>
                                <tbody id="all-files">
                                    <!-- æ–‡ä»¶åˆ—è¡¨å‹•æ…‹ç”Ÿæˆ -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- ä¸Šå‚³æ–‡ä»¶é é¢ -->
                <div id="upload-page" class="page">
                    <div class="content-card">
                        <div class="card-header">
                            <h2><i class="fas fa-upload"></i> ä¸Šå‚³æ–‡ä»¶</h2>
                        </div>
                        
                        <div class="upload-area" id="upload-area">
                            <i class="fas fa-cloud-upload-alt" style="font-size: 3rem; color: var(--primary-color); margin-bottom: 15px;"></i>
                            <h3>æ‹–æ”¾æ–‡ä»¶åˆ°é€™è£¡ä¸Šå‚³</h3>
                            <p>æ”¯æŒå¤šç¨®æ–‡ä»¶æ ¼å¼ï¼Œå–®å€‹æ–‡ä»¶æœ€å¤§ 100MB</p>
                            <button class="btn btn-primary" id="browse-files" style="margin-top: 20px;">
                                <i class="fas fa-folder-open"></i> ç€è¦½æ–‡ä»¶
                            </button>
                            <input type="file" id="file-input" multiple style="display: none;">
                        </div>
                        
                        <div id="upload-progress" style="display: none; margin-top: 20px;">
                            <h3>ä¸Šå‚³é€²åº¦</h3>
                            <div style="background-color: #eee; height: 10px; border-radius: 5px; margin: 15px 0;">
                                <div id="progress-bar" style="background-color: var(--primary-color); height: 100%; width: 0%; border-radius: 5px;"></div>
                            </div>
                            <p id="progress-text">æ­£åœ¨æº–å‚™ä¸Šå‚³...</p>
                        </div>
                    </div>
                </div>

                <!-- ç·šä¸Šç·¨è¼¯é é¢ -->
                <div id="editor-page" class="page">
                    <div class="content-card">
                        <div class="card-header">
                            <h2><i class="fas fa-edit"></i> ç·šä¸Šæ–‡ä»¶ç·¨è¼¯å™¨</h2>
                            <button class="btn btn-primary" id="new-doc-btn">
                                <i class="fas fa-plus"></i> æ–°å»ºæ–‡æª”
                            </button>
                        </div>
                        
                        <div class="editor-container">
                            <div class="editor-toolbar">
                                <button class="btn" data-format="bold">
                                    <i class="fas fa-bold"></i>
                                </button>
                                <button class="btn" data-format="italic">
                                    <i class="fas fa-italic"></i>
                                </button>
                                <button class="btn" data-format="code">
                                    <i class="fas fa-code"></i>
                                </button>
                                <button class="btn" id="preview-toggle">
                                    <i class="fas fa-eye"></i> é è¦½
                                </button>
                                <button class="btn btn-success" id="save-doc-btn">
                                    <i class="fas fa-save"></i> ä¿å­˜
                                </button>
                            </div>
                            
                            <div class="editor-content">
                                <textarea id="editor-textarea" placeholder="é–‹å§‹æ’°å¯«æ‚¨çš„å…§å®¹...&#10;&#10;æ”¯æŒMarkdownèªæ³•ï¼š&#10;# æ¨™é¡Œ&#10;- åˆ—è¡¨é …&#10;**ç²—é«”æ–‡å­—**&#10;*æ–œé«”æ–‡å­—*&#10;"># æ­¡è¿ä½¿ç”¨ç·šä¸Šç·¨è¼¯å™¨

é€™æ˜¯ä¸€å€‹ç°¡å–®çš„ç·šä¸Šæ–‡ä»¶ç·¨è¼¯ç³»çµ±ï¼Œé¡ä¼¼Google Docsçš„åŸºç¤åŠŸèƒ½ã€‚

## åŠŸèƒ½ç‰¹é»
- ğŸ“ **å³æ™‚ç·¨è¼¯** - è¼¸å…¥å…§å®¹å³æ™‚ä¿å­˜
- ğŸ’¾ **è‡ªå‹•ä¿å­˜** - æ¯30ç§’è‡ªå‹•ä¿å­˜åˆ°æœ¬åœ°
- ğŸ“„ **Markdownæ”¯æŒ** - æ”¯æŒåŸºæœ¬çš„Markdownèªæ³•

## å¿«é€Ÿé–‹å§‹
1. é–‹å§‹ç·¨è¼¯å…§å®¹
2. ç³»çµ±æœƒè‡ªå‹•ä¿å­˜æ‚¨çš„æ›´æ”¹
3. ä½¿ç”¨é è¦½åŠŸèƒ½æŸ¥çœ‹æ¸²æŸ“æ•ˆæœ

é–‹å§‹å‰µä½œå§ï¼</textarea>
                                
                                <div id="preview-area">
                                    <div id="preview-content"></div>
                                </div>
                            </div>
                            
                            <div class="editor-status">
                                <div>
                                    <span id="last-modified">å¾æœªä¿å­˜</span>
                                </div>
                                <div>
                                    <span id="save-status" class="save-status saved">å·²ä¿å­˜</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ç”¨æˆ¶ç®¡ç†é é¢ -->
                <div id="users-page" class="page">
                    <div class="content-card">
                        <div class="card-header">
                            <h2><i class="fas fa-users"></i> ç”¨æˆ¶ç®¡ç†</h2>
                            <button class="btn btn-primary" id="add-user-btn">
                                <i class="fas fa-user-plus"></i> æ·»åŠ ç”¨æˆ¶
                            </button>
                        </div>
                        
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>ç”¨æˆ¶å</th>
                                        <th>è§’è‰²</th>
                                        <th>ç‹€æ…‹</th>
                                        <th>è¨»å†Šæ™‚é–“</th>
                                        <th>æ“ä½œ</th>
                                    </tr>
                                </thead>
                                <tbody id="users-list">
                                    <!-- ç”¨æˆ¶åˆ—è¡¨å‹•æ…‹ç”Ÿæˆ -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- æ•¸æ“šå‚™ä»½é é¢ -->
                <div id="backup-page" class="page">
                    <div class="content-card">
                        <div class="card-header">
                            <h2><i class="fas fa-database"></i> æ•¸æ“šå‚™ä»½èˆ‡æ¢å¾©</h2>
                        </div>
                        
                        <div style="margin: 20px 0;">
                            <div style="margin-bottom: 30px;">
                                <h3>å‚™ä»½æ•¸æ“š</h3>
                                <p>å°‡ç•¶å‰æ‰€æœ‰æ•¸æ“šå°å‡ºç‚ºJSONæ–‡ä»¶</p>
                                <button class="btn btn-primary" id="export-data-btn">
                                    <i class="fas fa-file-export"></i> å°å‡ºæ•¸æ“š
                                </button>
                            </div>
                            
                            <div style="margin-bottom: 30px;">
                                <h3>æ¢å¾©æ•¸æ“š</h3>
                                <p>å¾JSONæ–‡ä»¶å°å…¥æ•¸æ“šï¼ˆå°‡è¦†è“‹ç¾æœ‰æ•¸æ“šï¼‰</p>
                                <input type="file" id="import-file" accept=".json" style="display: none;">
                                <button class="btn btn-warning" id="import-data-btn">
                                    <i class="fas fa-file-import"></i> å°å…¥æ•¸æ“š
                                </button>
                            </div>
                            
                            <div style="margin-bottom: 30px;">
                                <h3>é‡ç½®ç³»çµ±</h3>
                                <p>æ¸…é™¤æ‰€æœ‰æ•¸æ“šï¼Œæ¢å¾©åˆ°åˆå§‹ç‹€æ…‹</p>
                                <button class="btn btn-danger" id="reset-data-btn">
                                    <i class="fas fa-trash"></i> é‡ç½®æ‰€æœ‰æ•¸æ“š
                                </button>
                            </div>
                            
                            <div style="padding: 15px; background-color: #fff3cd; border-radius: 5px;">
                                <h4><i class="fas fa-info-circle"></i> é‡è¦æç¤º</h4>
                                <p style="font-size: 0.9rem; margin-top: 5px;">
                                    æ•¸æ“šå­˜å„²åœ¨ç€è¦½å™¨LocalStorageä¸­ï¼Œæ¸…é™¤ç€è¦½å™¨æ•¸æ“šå°‡ä¸Ÿå¤±æ‰€æœ‰æ•¸æ“šã€‚
                                    å»ºè­°å®šæœŸå‚™ä»½é‡è¦æ•¸æ“šã€‚
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- æ·»åŠ ç”¨æˆ¶æ¨¡æ…‹æ¡† -->
    <div class="modal" id="add-user-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>æ·»åŠ æ–°ç”¨æˆ¶</h3>
                <button class="close-modal" id="close-add-user-modal">&times;</button>
            </div>
            <form id="add-user-form">
                <div class="form-group">
                    <label>ç”¨æˆ¶å</label>
                    <input type="text" id="new-username" class="form-control" required>
                </div>
                <div class="form-group">
                    <label>å¯†ç¢¼</label>
                    <input type="password" id="new-password" class="form-control" required>
                </div>
                <div class="form-group">
                    <label>è§’è‰²</label>
                    <select id="user-role-select" class="form-control">
                        <option value="user">æ™®é€šç”¨æˆ¶</option>
                        <option value="admin">ç®¡ç†å“¡</option>
                    </select>
                </div>
                <button type="submit" class="btn btn-primary btn-block">æ·»åŠ ç”¨æˆ¶</button>
            </form>
        </div>
    </div>

    <script>
        // ============================
        // å®Œæ•´æ–‡ä»¶ç®¡ç†ç³»çµ± JavaScript
        // ============================
        
        const STORAGE_KEY = 'complete_file_manager_v2';
        let currentData = null;
        let currentUser = null;
        let currentFileId = null;
        let saveTimer = null;
        
        // é»˜èªæ•¸æ“š
        const defaultData = {
            users: [
                {
                    id: 1,
                    username: 'admin',
                    fullname: 'ç³»çµ±ç®¡ç†å“¡',
                    email: 'admin@example.com',
                    role: 'admin',
                    createdAt: '2023-01-15',
                    status: 'active',
                    password: 'password123'
                },
                {
                    id: 2,
                    username: 'user1',
                    fullname: 'æ™®é€šç”¨æˆ¶',
                    email: 'user1@example.com',
                    role: 'user',
                    createdAt: '2023-02-20',
                    status: 'active',
                    password: 'password123'
                }
            ],
            files: [
                {
                    id: 1,
                    name: 'æ­¡è¿æ–‡ä»¶.txt',
                    type: 'txt',
                    size: '2.4 KB',
                    uploader: 'admin',
                    uploadedAt: '2023-10-28 14:30',
                    icon: 'txt',
                    content: '# æ­¡è¿ä½¿ç”¨æ–‡ä»¶ç®¡ç†ç³»çµ±\n\né€™æ˜¯ä¸€å€‹å®Œæ•´çš„æ–‡ä»¶ç®¡ç†ç³»çµ±ï¼ŒåŒ…å«æ–‡ä»¶ç®¡ç†å’Œç·šä¸Šç·¨è¼¯åŠŸèƒ½ã€‚'
                },
                {
                    id: 2,
                    name: 'é …ç›®å ±å‘Š.pdf',
                    type: 'pdf',
                    size: '2.4 MB',
                    uploader: 'admin',
                    uploadedAt: '2023-10-27 10:15',
                    icon: 'pdf'
                },
                {
                    id: 3,
                    name: 'è¨­è¨ˆæ–‡æª”.docx',
                    type: 'doc',
                    size: '1.8 MB',
                    uploader: 'user1',
                    uploadedAt: '2023-10-26 16:45',
                    icon: 'doc'
                }
            ],
            documents: [
                {
                    id: 1,
                    name: 'æ­¡è¿æ–‡æª”',
                    content: `# æ­¡è¿ä½¿ç”¨ç·šä¸Šç·¨è¼¯å™¨

é€™æ˜¯ä¸€å€‹ç°¡å–®çš„ç·šä¸Šæ–‡ä»¶ç·¨è¼¯ç³»çµ±ï¼Œé¡ä¼¼Google Docsçš„åŸºç¤åŠŸèƒ½ã€‚

## åŠŸèƒ½ç‰¹é»
- ğŸ“ **å³æ™‚ç·¨è¼¯** - è¼¸å…¥å…§å®¹å³æ™‚ä¿å­˜
- ğŸ’¾ **è‡ªå‹•ä¿å­˜** - æ¯30ç§’è‡ªå‹•ä¿å­˜åˆ°æœ¬åœ°
- ğŸ“„ **Markdownæ”¯æŒ** - æ”¯æŒåŸºæœ¬çš„Markdownèªæ³•

## å¿«é€Ÿé–‹å§‹
1. é–‹å§‹ç·¨è¼¯å…§å®¹
2. ç³»çµ±æœƒè‡ªå‹•ä¿å­˜æ‚¨çš„æ›´æ”¹
3. ä½¿ç”¨é è¦½åŠŸèƒ½æŸ¥çœ‹æ¸²æŸ“æ•ˆæœ

é–‹å§‹å‰µä½œå§ï¼`,
                    type: 'markdown',
                    createdAt: new Date().toISOString(),
                    updatedAt: new Date().toISOString(),
                    createdBy: 'admin'
                }
            ],
            settings: {
                autoSave: true,
                autoSaveInterval: 30
            }
        };
        
        // åˆå§‹åŒ–ç³»çµ±
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ç³»çµ±åˆå§‹åŒ–...');
            
            // åŠ è¼‰æ•¸æ“š
            loadData();
            
            // ç™»éŒ„è¡¨å–®
            document.getElementById('login-form').addEventListener('submit', function(e) {
                e.preventDefault();
                login();
            });
            
            // åˆå§‹åŒ–äº‹ä»¶ç›£è½å™¨
            initEventListeners();
            
            console.log('ç³»çµ±åˆå§‹åŒ–å®Œæˆ');
        });
        
        // åŠ è¼‰æ•¸æ“š
        function loadData() {
            try {
                const savedData = localStorage.getItem(STORAGE_KEY);
                if (savedData) {
                    currentData = JSON.parse(savedData);
                    console.log('å¾æœ¬åœ°å­˜å„²åŠ è¼‰æ•¸æ“š');
                } else {
                    currentData = JSON.parse(JSON.stringify(defaultData));
                    console.log('ä½¿ç”¨é»˜èªæ•¸æ“š');
                    saveData();
                }
            } catch (error) {
                console.error('åŠ è¼‰æ•¸æ“šå¤±æ•—:', error);
                currentData = JSON.parse(JSON.stringify(defaultData));
                saveData();
            }
        }
        
        // ä¿å­˜æ•¸æ“š
        function saveData() {
            try {
                localStorage.setItem(STORAGE_KEY, JSON.stringify(currentData));
                console.log('æ•¸æ“šä¿å­˜æˆåŠŸ');
                updateDashboardStats();
                return true;
            } catch (error) {
                console.error('ä¿å­˜æ•¸æ“šå¤±æ•—:', error);
                return false;
            }
        }
        
        // ç”¨æˆ¶ç™»éŒ„
        function login() {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            const user = currentData.users.find(u => 
                u.username === username && 
                u.password === password &&
                u.status === 'active'
            );
            
            if (user) {
                currentUser = { ...user };
                delete currentUser.password;
                
                // åˆ‡æ›åˆ°ä¸»ç•Œé¢
                document.getElementById('login-page').style.display = 'none';
                document.getElementById('app-page').style.display = 'block';
                
                // æ›´æ–°ç”¨æˆ¶ç•Œé¢
                updateUserInfo();
                
                // åŠ è¼‰å„€è¡¨æ¿
                loadDashboard();
                
                // å•Ÿå‹•è‡ªå‹•ä¿å­˜
                startAutoSave();
                
                console.log('ç”¨æˆ¶ç™»éŒ„æˆåŠŸ:', currentUser.username);
                
                // æ·»åŠ æ—¥èªŒ
                addLog('ç™»éŒ„ç³»çµ±', 'ç”¨æˆ¶ç™»éŒ„æˆåŠŸ');
            } else {
                alert('ç™»éŒ„å¤±æ•—ï¼è«‹æª¢æŸ¥ç”¨æˆ¶åå’Œå¯†ç¢¼ã€‚\né»˜èªè³¬è™Ÿï¼šadmin / password123');
            }
        }
        
        // åˆå§‹åŒ–äº‹ä»¶ç›£è½å™¨
        function initEventListeners() {
            // ç™»å‡º
            document.getElementById('logout-btn').addEventListener('click', logout);
            
            // å°èˆªèœå–®
            document.querySelectorAll('.nav-links a').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    // æ›´æ–°æ´»å‹•ç‹€æ…‹
                    document.querySelectorAll('.nav-links a').forEach(item => {
                        item.classList.remove('active');
                    });
                    this.classList.add('active');
                    
                    // åˆ‡æ›é é¢
                    const pageId = this.getAttribute('data-page');
                    switchPage(pageId);
                });
            });
            
            // æŸ¥çœ‹æ‰€æœ‰æ–‡ä»¶
            document.getElementById('view-all-files').addEventListener('click', function() {
                switchPage('files');
                document.querySelector('[data-page="files"]').click();
            });
            
            // æ–‡ä»¶æœç´¢
            document.getElementById('search-files').addEventListener('click', function() {
                const searchTerm = document.getElementById('file-search').value.toLowerCase();
                filterFiles(searchTerm);
            });
            
            // æ–‡ä»¶ä¸Šå‚³
            setupFileUpload();
            
            // ç·šä¸Šç·¨è¼¯å™¨
            setupEditor();
            
            // ç”¨æˆ¶ç®¡ç†
            setupUserManagement();
            
            // æ•¸æ“šå‚™ä»½
            setupBackup();
        }
        
        // æ›´æ–°ç”¨æˆ¶ä¿¡æ¯
        function updateUserInfo() {
            document.getElementById('user-name').textContent = currentUser.fullname;
            document.getElementById('user-role').textContent = currentUser.role === 'admin' ? 'ç³»çµ±ç®¡ç†å“¡' : 'æ™®é€šç”¨æˆ¶';
            document.getElementById('user-avatar').textContent = currentUser.username.charAt(0).toUpperCase();
            document.getElementById('user-avatar').style.backgroundColor = currentUser.role === 'admin' ? '#f72585' : '#4cc9f0';
        }
        
        // åˆ‡æ›é é¢
        function switchPage(pageId) {
            // éš±è—æ‰€æœ‰é é¢
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            // é¡¯ç¤ºç›®æ¨™é é¢
            document.getElementById(`${pageId}-page`).classList.add('active');
            
            // æ›´æ–°é é¢æ¨™é¡Œ
            const pageTitles = {
                dashboard: 'æ§åˆ¶é¢æ¿',
                files: 'æ–‡ä»¶ç®¡ç†',
                upload: 'ä¸Šå‚³æ–‡ä»¶',
                editor: 'ç·šä¸Šç·¨è¼¯',
                users: 'ç”¨æˆ¶ç®¡ç†',
                backup: 'æ•¸æ“šå‚™ä»½'
            };
            
            const pageDescriptions = {
                dashboard: 'ç³»çµ±æ¦‚è¦½èˆ‡çµ±è¨ˆä¿¡æ¯',
                files: 'ç®¡ç†æ‰€æœ‰ä¸Šå‚³çš„æ–‡ä»¶',
                upload: 'ä¸Šå‚³æ–°æ–‡ä»¶åˆ°ç³»çµ±',
                editor: 'å‰µå»ºå’Œç·¨è¼¯ç·šä¸Šæ–‡æª”',
                users: 'ç®¡ç†ç³»çµ±ç”¨æˆ¶èˆ‡æ¬Šé™',
                backup: 'å‚™ä»½å’Œæ¢å¾©ç³»çµ±æ•¸æ“š'
            };
            
            document.getElementById('page-title').textContent = pageTitles[pageId];
            document.getElementById('page-description').textContent = pageDescriptions[pageId];
            
            // åŠ è¼‰é é¢æ•¸æ“š
            if (pageId === 'dashboard') {
                loadDashboard();
            } else if (pageId === 'files') {
                loadAllFiles();
            } else if (pageId === 'editor') {
                loadEditor();
            } else if (pageId === 'users') {
                loadUsers();
            }
        }
        
        // æ›´æ–°å„€è¡¨æ¿çµ±è¨ˆ
        function updateDashboardStats() {
            document.getElementById('total-files').textContent = currentData.files.length;
            document.getElementById('total-users').textContent = currentData.users.length;
            
            // è¨ˆç®—å­˜å„²å¤§å°
            let totalSize = 0;
            currentData.files.forEach(file => {
                const sizeNum = parseFloat(file.size);
                if (file.size.includes('MB')) totalSize += sizeNum;
                else if (file.size.includes('KB')) totalSize += sizeNum / 1024;
                else if (file.size.includes('GB')) totalSize += sizeNum * 1024;
            });
            
            document.getElementById('total-storage').textContent = totalSize.toFixed(1) + ' MB';
        }
        
        // åŠ è¼‰å„€è¡¨æ¿
        function loadDashboard() {
            updateDashboardStats();
            
            const recentFilesContainer = document.getElementById('recent-files');
            recentFilesContainer.innerHTML = '';
            
            const recentFiles = currentData.files.slice(0, 5);
            
            if (recentFiles.length === 0) {
                recentFilesContainer.innerHTML = `
                    <tr>
                        <td colspan="5" style="text-align: center; padding: 40px; color: var(--gray-color);">
                            <i class="fas fa-folder-open" style="font-size: 2rem; margin-bottom: 15px; display: block;"></i>
                            æš«ç„¡æ–‡ä»¶
                        </td>
                    </tr>
                `;
                return;
            }
            
            recentFiles.forEach(file => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>
                        <div class="file-info">
                            <div class="file-icon ${file.icon}">
                                <i class="fas fa-file-${file.icon === 'other' ? 'alt' : file.icon}"></i>
                            </div>
                            <div>
                                <div>${file.name}</div>
                                <div style="font-size: 0.9rem; color: var(--gray-color);">${file.size}</div>
                            </div>
                        </div>
                    </td>
                    <td>${getFileTypeName(file.type)}</td>
                    <td>${file.size}</td>
                    <td>${file.uploadedAt}</td>
                    <td>
                        <div class="file-actions">
                            <button class="action-btn" title="ä¸‹è¼‰" onclick="downloadFile(${file.id})">
                                <i class="fas fa-download"></i>
                            </button>
                            <button class="action-btn" title="åˆªé™¤" onclick="deleteFile(${file.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                `;
                recentFilesContainer.appendChild(row);
            });
        }
        
        // åŠ è¼‰æ‰€æœ‰æ–‡ä»¶
        function loadAllFiles() {
            const allFilesContainer = document.getElementById('all-files');
            allFilesContainer.innerHTML = '';
            
            if (currentData.files.length === 0) {
                allFilesContainer.innerHTML = `
                    <tr>
                        <td colspan="5" style="text-align: center; padding: 40px; color: var(--gray-color);">
                            <i class="fas fa-folder-open" style="font-size: 2rem; margin-bottom: 15px; display: block;"></i>
                            æš«ç„¡æ–‡ä»¶
                        </td>
                    </tr>
                `;
                return;
            }
            
            currentData.files.forEach(file => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>
                        <div class="file-info">
                            <div class="file-icon ${file.icon}">
                                <i class="fas fa-file-${file.icon === 'other' ? 'alt' : file.icon}"></i>
                            </div>
                            <div>
                                <div>${file.name}</div>
                                <div style="font-size: 0.9rem; color: var(--gray-color);">${file.size}</div>
                            </div>
                        </div>
                    </td>
                    <td>${getFileTypeName(file.type)}</td>
                    <td>${file.size}</td>
                    <td>${file.uploadedAt}</td>
                    <td>
                        <div class="file-actions">
                            <button class="action-btn" title="ä¸‹è¼‰" onclick="downloadFile(${file.id})">
                                <i class="fas fa-download"></i>
                            </button>
                            ${file.type === 'txt' ? `
                                <button class="action-btn" title="ç·¨è¼¯" onclick="editFile(${file.id})">
                                    <i class="fas fa-edit"></i>
                                </button>
                            ` : ''}
                            <button class="action-btn" title="åˆªé™¤" onclick="deleteFile(${file.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                `;
                allFilesContainer.appendChild(row);
            });
        }
        
        // éæ¿¾æ–‡ä»¶
        function filterFiles(searchTerm) {
            const filteredFiles = currentData.files.filter(file => 
                file.name.toLowerCase().includes(searchTerm) ||
                file.type.toLowerCase().includes(searchTerm)
            );
            
            const allFilesContainer = document.getElementById('all-files');
            allFilesContainer.innerHTML = '';
            
            if (filteredFiles.length === 0) {
                allFilesContainer.innerHTML = `
                    <tr>
                        <td colspan="5" style="text-align: center; padding: 40px; color: var(--gray-color);">
                            <i class="fas fa-search" style="font-size: 2rem; margin-bottom: 15px; display: block;"></i>
                            æœªæ‰¾åˆ°åŒ¹é…çš„æ–‡ä»¶
                        </td>
                    </tr>
                `;
                return;
            }
            
            filteredFiles.forEach(file => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>
                        <div class="file-info">
                            <div class="file-icon ${file.icon}">
                                <i class="fas fa-file-${file.icon === 'other' ? 'alt' : file.icon}"></i>
                            </div>
                            <div>
                                <div>${file.name}</div>
                                <div style="font-size: 0.9rem; color: var(--gray-color);">${file.size}</div>
                            </div>
                        </div>
                    </td>
                    <td>${getFileTypeName(file.type)}</td>
                    <td>${file.size}</td>
                    <td>${file.uploadedAt}</td>
                    <td>
                        <div class="file-actions">
                            <button class="action-btn" title="ä¸‹è¼‰" onclick="downloadFile(${file.id})">
                                <i class="fas fa-download"></i>
                            </button>
                            <button class="action-btn" title="åˆªé™¤" onclick="deleteFile(${file.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                `;
                allFilesContainer.appendChild(row);
            });
        }
        
        // è¨­ç½®æ–‡ä»¶ä¸Šå‚³
        function setupFileUpload() {
            const uploadArea = document.getElementById('upload-area');
            const fileInput = document.getElementById('file-input');
            const browseFilesBtn = document.getElementById('browse-files');
            
            browseFilesBtn.addEventListener('click', function() {
                fileInput.click();
            });
            
            fileInput.addEventListener('change', function(e) {
                handleFilesUpload(e.target.files);
            });
            
            // æ‹–æ”¾ä¸Šå‚³
            uploadArea.addEventListener('dragover', function(e) {
                e.preventDefault();
                uploadArea.classList.add('dragover');
            });
            
            uploadArea.addEventListener('dragleave', function() {
                uploadArea.classList.remove('dragover');
            });
            
            uploadArea.addEventListener('drop', function(e) {
                e.preventDefault();
                uploadArea.classList.remove('dragover');
                
                if (e.dataTransfer.files.length) {
                    handleFilesUpload(e.dataTransfer.files);
                }
            });
        }
        
        // è™•ç†æ–‡ä»¶ä¸Šå‚³
        function handleFilesUpload(files) {
            const uploadProgress = document.getElementById('upload-progress');
            const progressBar = document.getElementById('progress-bar');
            const progressText = document.getElementById('progress-text');
            
            uploadProgress.style.display = 'block';
            
            let uploadedCount = 0;
            const totalFiles = files.length;
            
            Array.from(files).forEach((file, index) => {
                setTimeout(() => {
                    uploadedCount++;
                    const progress = (uploadedCount / totalFiles) * 100;
                    progressBar.style.width = `${progress}%`;
                    progressText.textContent = `æ­£åœ¨ä¸Šå‚³ ${uploadedCount}/${totalFiles}: ${file.name}`;
                    
                    // å‰µå»ºæ–‡ä»¶å°è±¡
                    const fileType = getFileExtension(file.name);
                    const fileSize = formatFileSize(file.size);
                    const fileIcon = getFileIconClass(fileType);
                    
                    const newFile = {
                        id: currentData.files.length + 1,
                        name: file.name,
                        type: fileType,
                        size: fileSize,
                        uploader: currentUser.username,
                        uploadedAt: new Date().toLocaleString('zh-CN'),
                        icon: fileIcon
                    };
                    
                    // å¦‚æœæ˜¯æ–‡æœ¬æ–‡ä»¶ï¼Œè®€å–å…§å®¹
                    if (fileType === 'txt') {
                        const reader = new FileReader();
                        reader.onload = function(e) {
                            newFile.content = e.target.result.substring(0, 10000); // é™åˆ¶å…§å®¹é•·åº¦
                        };
                        reader.readAsText(file);
                    }
                    
                    currentData.files.unshift(newFile);
                    saveData();
                    
                    addLog('ä¸Šå‚³æ–‡ä»¶', file.name);
                    
                    if (uploadedCount === totalFiles) {
                        progressText.textContent = 'ä¸Šå‚³å®Œæˆï¼';
                        setTimeout(() => {
                            uploadProgress.style.display = 'none';
                            progressBar.style.width = '0%';
                        }, 2000);
                        
                        // åˆ·æ–°æ–‡ä»¶åˆ—è¡¨
                        if (document.getElementById('files-page').classList.contains('active')) {
                            loadAllFiles();
                        } else {
                            loadDashboard();
                        }
                    }
                }, index * 1000);
            });
        }
        
        // è¨­ç½®ç·šä¸Šç·¨è¼¯å™¨
        function setupEditor() {
            const editorTextarea = document.getElementById('editor-textarea');
            const previewToggle = document.getElementById('preview-toggle');
            const saveDocBtn = document.getElementById('save-doc-btn');
            const newDocBtn = document.getElementById('new-doc-btn');
            
            // ä¿å­˜æ–‡æª”
            saveDocBtn.addEventListener('click', saveDocument);
            
            // æ–°å»ºæ–‡æª”
            newDocBtn.addEventListener('click', function() {
                currentFileId = null;
                editorTextarea.value = '# æ–°æ–‡æª”\n\né–‹å§‹æ’°å¯«æ‚¨çš„å…§å®¹...';
                document.getElementById('last-modified').textContent = 'å¾æœªä¿å­˜';
                document.getElementById('save-status').textContent = 'æœªä¿å­˜';
                document.getElementById('save-status').className = 'save-status unsaved';
            });
            
            // é è¦½åˆ‡æ›
            previewToggle.addEventListener('click', function() {
                const previewArea = document.getElementById('preview-area');
                const previewContent = document.getElementById('preview-content');
                
                if (previewArea.style.display === 'none') {
                    // åˆ‡æ›åˆ°é è¦½æ¨¡å¼
                    previewContent.innerHTML = markdownToHTML(editorTextarea.value);
                    editorTextarea.style.display = 'none';
                    previewArea.style.display = 'block';
                    this.innerHTML = '<i class="fas fa-edit"></i> ç·¨è¼¯';
                } else {
                    // åˆ‡æ›å›ç·¨è¼¯æ¨¡å¼
                    editorTextarea.style.display = 'block';
                    previewArea.style.display = 'none';
                    this.innerHTML = '<i class="fas fa-eye"></i> é è¦½';
                }
            });
            
            // è‡ªå‹•ä¿å­˜
            editorTextarea.addEventListener('input', function() {
                markUnsaved();
            });
            
            // æ ¼å¼æŒ‰éˆ•
            document.querySelectorAll('[data-format]').forEach(btn => {
                btn.addEventListener('click', function() {
                    applyFormat(this.dataset.format);
                });
            });
        }
        
        // åŠ è¼‰ç·¨è¼¯å™¨
        function loadEditor() {
            // å¦‚æœæœ‰æ–‡æª”ï¼ŒåŠ è¼‰ç¬¬ä¸€å€‹
            if (currentData.documents.length > 0 && !currentFileId) {
                currentFileId = currentData.documents[0].id;
                const doc = currentData.documents.find(d => d.id === currentFileId);
                if (doc) {
                    document.getElementById('editor-textarea').value = doc.content;
                    document.getElementById('last-modified').textContent = 
                        `æœ€å¾Œä¿®æ”¹: ${new Date(doc.updatedAt).toLocaleString('zh-CN')}`;
                    document.getElementById('save-status').textContent = 'å·²ä¿å­˜';
                    document.getElementById('save-status').className = 'save-status saved';
                }
            }
        }
        
        // ä¿å­˜æ–‡æª”
        function saveDocument() {
            const content = document.getElementById('editor-textarea').value;
            
            if (!currentFileId) {
                // æ–°å»ºæ–‡æª”
                const newDoc = {
                    id: Date.now(),
                    name: 'æœªå‘½åæ–‡æª”',
                    content: content,
                    type: 'markdown',
                    createdAt: new Date().toISOString(),
                    updatedAt: new Date().toISOString(),
                    createdBy: currentUser.username
                };
                
                currentData.documents.push(newDoc);
                currentFileId = newDoc.id;
            } else {
                // æ›´æ–°ç¾æœ‰æ–‡æª”
                const doc = currentData.documents.find(d => d.id === currentFileId);
                if (doc) {
                    doc.content = content;
                    doc.updatedAt = new Date().toISOString();
                }
            }
            
            saveData();
            
            document.getElementById('last-modified').textContent = 
                `æœ€å¾Œä¿®æ”¹: ${new Date().toLocaleString('zh-CN')}`;
            document.getElementById('save-status').textContent = 'å·²ä¿å­˜';
            document.getElementById('save-status').className = 'save-status saved';
            
            addLog('ä¿å­˜æ–‡æª”', 'ä¿å­˜ç·šä¸Šæ–‡æª”');
            
            alert('æ–‡æª”ä¿å­˜æˆåŠŸï¼');
        }
        
        // è¨­ç½®ç”¨æˆ¶ç®¡ç†
        function setupUserManagement() {
            document.getElementById('add-user-btn').addEventListener('click', function() {
                document.getElementById('add-user-modal').classList.add('active');
            });
            
            document.getElementById('close-add-user-modal').addEventListener('click', function() {
                document.getElementById('add-user-modal').classList.remove('active');
            });
            
            document.getElementById('add-user-form').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const newUser = {
                    id: currentData.users.length + 1,
                    username: document.getElementById('new-username').value,
                    password: document.getElementById('new-password').value,
                    fullname: document.getElementById('new-username').value,
                    email: `${document.getElementById('new-username').value}@example.com`,
                    role: document.getElementById('user-role-select').value,
                    createdAt: new Date().toISOString().split('T')[0],
                    status: 'active'
                };
                
                currentData.users.push(newUser);
                saveData();
                loadUsers();
                
                document.getElementById('add-user-modal').classList.remove('active');
                document.getElementById('add-user-form').reset();
                
                addLog('æ·»åŠ ç”¨æˆ¶', `æ·»åŠ ç”¨æˆ¶: ${newUser.username}`);
                
                alert('ç”¨æˆ¶æ·»åŠ æˆåŠŸï¼');
            });
        }
        
        // åŠ è¼‰ç”¨æˆ¶åˆ—è¡¨
        function loadUsers() {
            const usersList = document.getElementById('users-list');
            usersList.innerHTML = '';
            
            currentData.users.forEach(user => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <div style="width: 40px; height: 40px; border-radius: 50%; background-color: ${user.role === 'admin' ? '#f72585' : '#4cc9f0'}; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold;">
                                ${user.username.charAt(0).toUpperCase()}
                            </div>
                            <div>${user.username}</div>
                        </div>
                    </td>
                    <td>${user.role === 'admin' ? 'ç®¡ç†å“¡' : 'æ™®é€šç”¨æˆ¶'}</td>
                    <td><span style="color: ${user.status === 'active' ? 'green' : 'red'}">${user.status === 'active' ? 'æ´»èº' : 'ç¦ç”¨'}</span></td>
                    <td>${user.createdAt}</td>
                    <td>
                        ${user.username !== 'admin' ? `
                            <div class="file-actions">
                                <button class="action-btn" title="ç·¨è¼¯" onclick="editUser(${user.id})">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="action-btn" title="åˆªé™¤" onclick="deleteUser(${user.id})">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        ` : 'ç³»çµ±ç®¡ç†å“¡'}
                    </td>
                `;
                usersList.appendChild(row);
            });
        }
        
        // è¨­ç½®æ•¸æ“šå‚™ä»½
        function setupBackup() {
            document.getElementById('export-data-btn').addEventListener('click', exportData);
            document.getElementById('import-data-btn').addEventListener('click', function() {
                document.getElementById('import-file').click();
            });
            document.getElementById('import-file').addEventListener('change', importData);
            document.getElementById('reset-data-btn').addEventListener('click', resetData);
        }
        
        // å°å‡ºæ•¸æ“š
        function exportData() {
            try {
                const dataStr = JSON.stringify(currentData, null, 2);
                const blob = new Blob([dataStr], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                
                const a = document.createElement('a');
                a.href = url;
                a.download = `file-manager-backup-${new Date().toISOString().split('T')[0]}.json`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                alert('æ•¸æ“šå‚™ä»½æˆåŠŸï¼æ–‡ä»¶å·²ä¸‹è¼‰ã€‚');
            } catch (error) {
                console.error('å°å‡ºæ•¸æ“šå¤±æ•—:', error);
                alert('å°å‡ºæ•¸æ“šå¤±æ•—ï¼');
            }
        }
        
        // å°å…¥æ•¸æ“š
        function importData(e) {
            const file = e.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const importedData = JSON.parse(e.target.result);
                    
                    if (confirm('å°å…¥æ•¸æ“šå°‡è¦†è“‹ç¾æœ‰æ•¸æ“šï¼Œç¢ºå®šè¦ç¹¼çºŒå—ï¼Ÿ')) {
                        currentData = importedData;
                        saveData();
                        alert('æ•¸æ“šå°å…¥æˆåŠŸï¼é é¢å°‡åˆ·æ–°ã€‚');
                        location.reload();
                    }
                } catch (error) {
                    console.error('å°å…¥æ•¸æ“šå¤±æ•—:', error);
                    alert('å°å…¥å¤±æ•—ï¼šæ–‡ä»¶æ ¼å¼ç„¡æ•ˆæˆ–å·²æå£');
                }
            };
            reader.readAsText(file);
        }
        
        // é‡ç½®æ•¸æ“š
        function resetData() {
            if (confirm('ç¢ºå®šè¦é‡ç½®æ‰€æœ‰æ•¸æ“šå—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤éŠ·ï¼Œè«‹å…ˆå‚™ä»½é‡è¦æ•¸æ“šï¼')) {
                localStorage.removeItem(STORAGE_KEY);
                alert('æ•¸æ“šå·²é‡ç½®ï¼Œé é¢å°‡åˆ·æ–°...');
                location.reload();
            }
        }
        
        // å·¥å…·å‡½æ•¸
        function getFileExtension(filename) {
            const ext = filename.split('.').pop().toLowerCase();
            if (['pdf', 'doc', 'docx', 'xls', 'xlsx', 'ppt', 'pptx'].includes(ext)) {
                return ext;
            } else if (['jpg', 'jpeg', 'png', 'gif', 'bmp', 'svg'].includes(ext)) {
                return 'img';
            } else if (['zip', 'rar', '7z', 'tar', 'gz'].includes(ext)) {
                return 'zip';
            } else if (['txt', 'md', 'js', 'html', 'css', 'json'].includes(ext)) {
                return 'txt';
            } else {
                return 'other';
            }
        }
        
        function getFileIconClass(fileType) {
            if (['pdf', 'doc', 'docx', 'xls', 'xlsx', 'ppt', 'pptx'].includes(fileType)) {
                return fileType === 'pdf' ? 'pdf' : 'doc';
            } else if (fileType === 'img') {
                return 'img';
            } else if (fileType === 'zip') {
                return 'zip';
            } else if (fileType === 'txt') {
                return 'txt';
            } else {
                return 'other';
            }
        }
        
        function getFileTypeName(fileType) {
            const typeMap = {
                'pdf': 'PDFæ–‡æª”',
                'doc': 'Wordæ–‡æª”',
                'docx': 'Wordæ–‡æª”',
                'xls': 'Excelè¡¨æ ¼',
                'xlsx': 'Excelè¡¨æ ¼',
                'ppt': 'PowerPointæ¼”ç¤º',
                'pptx': 'PowerPointæ¼”ç¤º',
                'img': 'åœ–ç‰‡æ–‡ä»¶',
                'zip': 'å£“ç¸®æ–‡ä»¶',
                'txt': 'æ–‡æœ¬æ–‡ä»¶',
                'other': 'å…¶ä»–æ–‡ä»¶'
            };
            return typeMap[fileType] || 'æœªçŸ¥æ–‡ä»¶';
        }
        
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
        }
        
        function markUnsaved() {
            const status = document.getElementById('save-status');
            status.textContent = 'æœªä¿å­˜';
            status.className = 'save-status unsaved';
            
            if (saveTimer) {
                clearTimeout(saveTimer);
            }
            
            saveTimer = setTimeout(() => {
                saveDocument();
            }, 30000); // 30ç§’å¾Œè‡ªå‹•ä¿å­˜
        }
        
        function applyFormat(format) {
            const textarea = document.getElementById('editor-textarea');
            const start = textarea.selectionStart;
            const end = textarea.selectionEnd;
            const selectedText = textarea.value.substring(start, end);
            
            let formattedText = '';
            
            switch (format) {
                case 'bold':
                    formattedText = `**${selectedText || 'ç²—é«”æ–‡å­—'}**`;
                    break;
                case 'italic':
                    formattedText = `*${selectedText || 'æ–œé«”æ–‡å­—'}*`;
                    break;
                case 'code':
                    formattedText = `\`${selectedText || 'ä»£ç¢¼'}\``;
                    break;
            }
            
            textarea.value = textarea.value.substring(0, start) + 
                            formattedText + 
                            textarea.value.substring(end);
            
            const newCursorPos = start + formattedText.length;
            textarea.focus();
            textarea.setSelectionRange(newCursorPos, newCursorPos);
            
            markUnsaved();
        }
        
        function markdownToHTML(markdown) {
            let html = markdown;
            
            // æ¨™é¡Œ
            html = html.replace(/^# (.*$)/gm, '<h1>$1</h1>');
            html = html.replace(/^## (.*$)/gm, '<h2>$1</h2>');
            html = html.replace(/^### (.*$)/gm, '<h3>$1</h3>');
            
            // ç²—é«”
            html = html.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
            
            // æ–œé«”
            html = html.replace(/\*(.*?)\*/g, '<em>$1</em>');
            
            // è¡Œå…§ä»£ç¢¼
            html = html.replace(/`(.*?)`/g, '<code>$1</code>');
            
            // ä»£ç¢¼å¡Š
            html = html.replace(/```([\s\S]*?)```/g, '<pre><code>$1</code></pre>');
            
            // ç„¡åºåˆ—è¡¨
            html = html.replace(/^- (.*$)/gm, '<li>$1</li>');
            html = html.replace(/(<li>.*<\/li>)/gs, '<ul>$1</ul>');
            
            // æœ‰åºåˆ—è¡¨
            html = html.replace(/^\d+\. (.*$)/gm, '<li>$1</li>');
            html = html.replace(/(<li>.*<\/li>)/gs, '<ol>$1</ol>');
            
            // æ®µè½
            html = html.replace(/^(?!<[hluo]|<\/[hluo]|<pre|<ul|<ol|<li)(.*)$/gm, '<p>$1</p>');
            
            // æ°´å¹³ç·š
            html = html.replace(/^-{3,}$/gm, '<hr>');
            
            return html;
        }
        
        function addLog(action, details) {
            // é€™è£¡å¯ä»¥æ·»åŠ æ—¥èªŒè¨˜éŒ„åŠŸèƒ½
            console.log(`[${new Date().toLocaleString('zh-CN')}] ${currentUser.username} ${action}: ${details}`);
        }
        
        function startAutoSave() {
            setInterval(() => {
                if (currentUser) {
                    saveData();
                }
            }, 30000); // æ¯30ç§’è‡ªå‹•ä¿å­˜æ•¸æ“š
        }
        
        // å…¨å±€å‡½æ•¸
        window.downloadFile = function(fileId) {
            const file = currentData.files.find(f => f.id === fileId);
            if (file) {
                let content = '';
                if (file.content) {
                    content = file.content;
                } else {
                    content = `æ–‡ä»¶å: ${file.name}\nå¤§å°: ${file.size}\nä¸Šå‚³è€…: ${file.uploader}\nä¸Šå‚³æ™‚é–“: ${file.uploadedAt}`;
                }
                
                const blob = new Blob([content], { type: 'text/plain' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = file.name;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                addLog('ä¸‹è¼‰æ–‡ä»¶', file.name);
            }
        };
        
        window.deleteFile = function(fileId) {
            if (!confirm('ç¢ºå®šè¦åˆªé™¤é€™å€‹æ–‡ä»¶å—ï¼Ÿ')) return;
            
            const fileIndex = currentData.files.findIndex(f => f.id === fileId);
            if (fileIndex !== -1) {
                const fileName = currentData.files[fileIndex].name;
                currentData.files.splice(fileIndex, 1);
                saveData();
                
                if (document.getElementById('files-page').classList.contains('active')) {
                    loadAllFiles();
                } else {
                    loadDashboard();
                }
                
                addLog('åˆªé™¤æ–‡ä»¶', fileName);
                alert('æ–‡ä»¶å·²åˆªé™¤ï¼');
            }
        };
        
        window.editFile = function(fileId) {
            const file = currentData.files.find(f => f.id === fileId);
            if (file && file.type === 'txt') {
                // åˆ‡æ›åˆ°ç·¨è¼¯å™¨é é¢ä¸¦åŠ è¼‰æ–‡ä»¶å…§å®¹
                switchPage('editor');
                document.querySelector('[data-page="editor"]').click();
                
                document.getElementById('editor-textarea').value = file.content || '';
                currentFileId = fileId;
                markUnsaved();
            }
        };
        
        window.editUser = function(userId) {
            const user = currentData.users.find(u => u.id === userId);
            if (user && user.username !== 'admin') {
                const newRole = prompt('ä¿®æ”¹ç”¨æˆ¶è§’è‰² (admin/user):', user.role);
                if (newRole && ['admin', 'user'].includes(newRole)) {
                    user.role = newRole;
                    saveData();
                    loadUsers();
                    alert('ç”¨æˆ¶è§’è‰²å·²æ›´æ–°ï¼');
                }
            }
        };
        
        window.deleteUser = function(userId) {
            const user = currentData.users.find(u => u.id === userId);
            if (user && user.username !== 'admin') {
                if (confirm(`ç¢ºå®šè¦åˆªé™¤ç”¨æˆ¶ "${user.username}" å—ï¼Ÿ`)) {
                    const userIndex = currentData.users.findIndex(u => u.id === userId);
                    currentData.users.splice(userIndex, 1);
                    saveData();
                    loadUsers();
                    alert('ç”¨æˆ¶å·²åˆªé™¤ï¼');
                }
            } else {
                alert('ä¸èƒ½åˆªé™¤ç®¡ç†å“¡è³¬æˆ¶ï¼');
            }
        };
        
        // ç”¨æˆ¶ç™»å‡º
        function logout() {
            if (confirm('ç¢ºå®šè¦é€€å‡ºå—ï¼Ÿ')) {
                // ä¿å­˜ç•¶å‰æ•¸æ“š
                saveData();
                
                // é‡ç½®ç‹€æ…‹
                currentUser = null;
                currentFileId = null;
                
                // åˆ‡æ›åˆ°ç™»éŒ„é é¢
                document.getElementById('app-page').style.display = 'none';
                document.getElementById('login-page').style.display = 'flex';
                
                console.log('ç”¨æˆ¶å·²ç™»å‡º');
            }
        }
    </script>
</body>
</html>
